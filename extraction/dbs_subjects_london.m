function [files, sequence, root, details] =dbs_subjects_london(initials, on)

dbsroot = '\\kraftwerk\vlad_shared';
outroot = 'C:\home\data\TimExtracts280716';

details = struct(...
    'berlin', 0, ...
    'hamburg', 0,...
    'boston', 0,...
    'cont_head_loc', 1,...
    'brainamp', 0,...
    'bipolar', 0,...
    'accelerometer', 0,...
    'badchanthresh', 0.2, ...
    'alignhead', 0,...
    'mridir', fullfile(dbsroot, initials, 'MRI'));

chan = {'STN_R01', 'STN_R12', 'STN_R23', 'STN_L01', 'STN_L12', 'STN_L23'};

details.oxford = isequal(initials(1:2), 'OX');

if details.oxford
    details.chanset      = fullfile(dbsroot, 'SPM', 'ox_meg_chan.mat');
    montage              = load(fullfile(dbsroot, 'SPM','ox_meg_montage.mat'));
    details.cont_head_loc = 0;
    details.eventchannel = 'STI101';
    details.eventtype    = 'STI101_up';
    details.lfpthresh = 2e6;
else
    details.chanset      = fullfile(dbsroot, 'SPM','dbs_meg_chan.mat');
    details.eventtype    = 'UPPT001_up';
    details.eventchannel = 'SCLK01';
    details.lfpthresh = 20;
    montage = load(fullfile(dbsroot, 'SPM','dbs_meg_montage.mat'));
end

megbad = {};

details.chanset = getfield(load(details.chanset), 'label');

name = fieldnames(montage);
montage = getfield(montage, name{1});

details.fiducials = fullfile(dbsroot, initials, 'MRI', [initials '_smri_fid.txt']);
details.movthresh = 0.01;

details.stim = 0;


switch initials
    case 'SW'
        if on
            files = {...
                '\SW\160207\Raw\sw260868_vladimirDBS_20070216_01.ds',...
                '\SW\160207\Raw\sw260868_vladimirDBS_20070216_02.ds',...
                '\SW\160207\Raw\sw260868_vladimirDBS_20070216_03.ds',...
                '\SW\160207\Raw\sw260868_vladimirDBS_20070216_04.ds',...
                '\SW\160207\Raw\sw260868_vladimirDBS_20070216_05.ds',...
                '\SW\160207\Raw\sw260868_vladimirDBS_20070216_06.ds',...
                '\SW\160207\Raw\sw260868_vladimirDBS_20070216_07.ds',...
                '\SW\160207\Raw\sw260568_vladimirDBS_20070216_01.ds',...
                '\SW\160207\Raw\sw260568_vladimirDBS_20070216_02.ds'};
            sequence = {'SL1', 'CR2', 'CL3', 'CR4', 'SR5', 'CL6', 'SL7', 'R1', 'SR2'};
            root='\SW\160207\';
        else
            files = {...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_01.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_02.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_03.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_04.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_05.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_06.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_07.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_08.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_09.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_10.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_11.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_12.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_13.ds',...
                '\SW\190207\Raw\sw260568_vladimirDBS_20070219_14.ds'};
            sequence = {'SR', 'R', 'SL', 'CR', 'SR', 'CL', 'CL', 'SL', 'CR', 'SR', 'SR', 'SL', 'CL', 'R'};
            root='\SW\190207\';
        end
        
        details.cont_head_loc = 0;
    case 'MW'
        if on
            files={...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_02.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_03.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_04.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_05.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_06.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_08.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_09.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_10.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_11.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_12.ds',...
                '\MW\310307\Raw\mw161052_vladimirDBS_20070331_13.ds'};
            sequence = {'CL2', 'SR3', 'CR4', 'R5', 'SR6', 'SL8', 'CR9', 'SL10', 'CL11', 'SR12', 'SL13'};
            root='\MW\310307\';
            details.movthresh = 0.03;
        else
            files={...
                '\MW\300307\Raw\mw161052_vladimirDBS_20070330_01.ds',...
                '\MW\300307\Raw\mw161052_vladimirDBS_20070330_02.ds',...
                '\MW\300307\Raw\mw161052_vladimirDBS_20070330_03.ds',...
                '\MW\300307\Raw\mw161052_vladimirDBS_20070330_04.ds',...
                '\MW\300307\Raw\mw161052_vladimirDBS_20070330_05.ds',...
                '\MW\300307\Raw\mw161052_vladimirDBS_20070330_06.ds',...
                '\MW\300307\Raw\mw161052_vladimirDBS_20070330_07.ds',...
                '\MW\300307\Raw\mw161052_vladimirDBS_20070330_08.ds',...
                '\MW\300307\Raw\mw161052_vladimirDBS_20070330_10.ds'};
            sequence = {'R', 'CR', 'SR', 'SL', 'CL', 'SR', 'CL', 'CR', 'SL'};
            root='\MW\300307\';
            details.movthresh = 0.03;
        end
        megbad = {'MLO42'};
    case 'JS'
        if on
            files={...
                '\JS\280707\Raw\js161040_vladimirDBS_20070728_04.ds',...
                '\JS\280707\Raw\js161040_vladimirDBS_20070728_05.ds',...
                '\JS\280707\Raw\js161040_vladimirDBS_20070728_06.ds',...
                '\JS\280707\Raw\js161040_vladimirDBS_20070728_07.ds',...
                '\JS\280707\Raw\js161040_vladimirDBS_20070728_08.ds',...
                '\JS\280707\Raw\js161040_vladimirDBS_20070728_09.ds',...
                '\JS\280707\Raw\js161040_vladimirDBS_20070728_10.ds',...
                '\JS\280707\Raw\js161040_vladimirDBS_20070728_11.ds'};
            sequence ={'R4', 'SR5',  'SL6', 'CL7', 'SL8', 'CL9', 'CR10', 'SR11'};
            root='\JS\280707\';
            details.movthresh = 0.05;
        end
        megbad = {'MLO42'};
    case 'KB'
        if on
            %{
            files={...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_01.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_02.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_03.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_04.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_05.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_06.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_07.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_08.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_09.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_10.ds',...
                '\KB\170907\Raw\kb300763_vladimirDBS_20070917_11.ds'};
            sequence ={'R1', 'CL2', 'SR3', 'SL4', 'CL5', 'CR6', 'SL7', 'SR8', 'CR9', 'R10', 'SL11' };
            chan={'STN_R01', 'STN_R12', 'STN_R23'};
            root='\KB\170907\';
            selectchan={'R12'};
            details.movthresh = 0.05;
            %}
        else
            files={...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_02.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_03.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_04.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_05.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_06.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_07.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_08.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_09.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_10.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_11.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_12.ds',...
                '\KB\190907\Raw\kb300763_vladimirDBS_20070919_13.ds'};
            sequence ={'SL', 'SR', 'SR', 'CL', 'CR', 'SL', 'R', 'CL', 'CR', 'CL', 'CR', 'R'};
            chan={'STN_R01', 'STN_R12', 'STN_R23'};
            root='\KB\190907\';
            details.movthresh = 0.04;
        end
        megbad = {'MLO42'};
    case 'LM'
        if on
            files={...
                '\LM\031107\Raw\ls050651_vladimirDBS_20071103_01.ds',...
                '\LM\031107\Raw\ls050651_vladimirDBS_20071103_02.ds',...
                '\LM\031107\Raw\ls050651_vladimirDBS_20071103_03.ds',...
                '\LM\031107\Raw\ls050651_vladimirDBS_20071103_04.ds',...
                '\LM\031107\Raw\ls050651_vladimirDBS_20071103_05.ds',...
                '\LM\031107\Raw\ls050651_vladimirDBS_20071103_06.ds',...
                '\LM\031107\Raw\ls050651_vladimirDBS_20071103_07.ds',...
                '\LM\031107\Raw\ls050651_vladimirDBS_20071103_08.ds',...
                '\LM\031107\Raw\ls050651_vladimirDBS_20071103_09.ds'};
            sequence ={'CR1', 'SL2', 'CL3', 'SR4', 'CR5', 'R6', 'SL7', 'CL8', 'SR9'};
            root='\LM\031107\';
            details.movthresh = 0.04;
        else
            files={...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_01.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_02.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_03.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_04.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_05.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_06.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_07.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_08.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_09.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_10.ds',...
                '\LM\021107\Raw\ls050651_vladimirDBS_20071102_11.ds'};
            sequence ={'SL1', 'CR2', 'SR3', 'CL4', 'R5', 'SR6', 'SL7', 'CL8', 'CR9', 'SL10', 'SR11'};
            root='\LM\021107\';
            details.movthresh = 0.02;
        end
        megbad = {'MLO42'};
        chan={'STN_R01', 'STN_R12', 'STN_R23', 'STN_L23'};
        ind = spm_match_str(montage.labelnew, {'STN_L01', 'STN_L12'});
        montage.labelnew(ind) = [];
        montage.tra(ind, :) = [];
    case 'PB'
        if on
            files={...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_01.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_02.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_03.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_04.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_05.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_06.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_07.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_08.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_09.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_10.ds',...
                '\PB\070208\Raw\pb280543_vladimirDBS_20080207_11.ds',...
                };
            sequence = {'R1', 'CR2', 'CR3', 'CR4', 'SL5', 'SL6', 'CL7', 'SR8', 'SR9', 'CR10', 'CL11'};
            root='\PB\070208\';
            details.movthresh = 0.04;
        end
        megbad = {'MLO42'};
    case 'JP'
        if on
            files={...
                '\JP\240208\Raw\jp180257_vladimirDBS_20080224_03.ds',...
                '\JP\240208\Raw\jp180257_vladimirDBS_20080224_04.ds',...
                '\JP\240208\Raw\jp180257_vladimirDBS_20080224_05.ds',...
                '\JP\240208\Raw\jp180257_vladimirDBS_20080224_06.ds',...
                '\JP\240208\Raw\jp180257_vladimirDBS_20080224_07.ds',...
                '\JP\240208\Raw\jp180257_vladimirDBS_20080224_08.ds',...
                '\JP\240208\Raw\jp180257_vladimirDBS_20080224_09.ds',...
                '\JP\240208\Raw\jp180257_vladimirDBS_20080224_10.ds',...
                '\JP\240208\Raw\jp180257_vladimirDBS_20080224_11.ds',...
                };
            sequence = {'CL3', 'SL4', 'SR5', 'R6', 'CR7', 'CR8', 'SR9', 'SL10', 'CL11'};
            root='\JP\240208\';
            details.movthresh = 0.02;
        else
            files={...
                '\JP\230208\Raw\jp180257_vladimirDBS_20080223_01.ds',...
                '\JP\230208\Raw\jp180257_vladimirDBS_20080223_02.ds',...
                '\JP\230208\Raw\jp180257_vladimirDBS_20080223_03.ds',...
                '\JP\230208\Raw\jp180257_vladimirDBS_20080223_04.ds',...
                '\JP\230208\Raw\jp180257_vladimirDBS_20080223_05.ds',...
                '\JP\230208\Raw\jp180257_vladimirDBS_20080223_06.ds',...
                '\JP\230208\Raw\jp180257_vladimirDBS_20080223_07.ds',...
                '\JP\230208\Raw\jp180257_vladimirDBS_20080223_08.ds',...
                '\JP\230208\Raw\jp180257_vladimirDBS_20080223_09.ds'
                };
            sequence = {'CL1', 'CR2', 'CL3', 'SR4', 'SR5', 'CR6', 'SL7', 'R8', 'SL9'};
            root='\JP\230208\';
            details.movthresh = 0.02;
        end
        megbad = {'MLO42'};
    case 'DS'
        if on
            files={...
                '\DS\260208\Raw\ds150148_vladimirDBS_20080226_02.ds',...
                '\DS\260208\Raw\ds150148_vladimirDBS_20080226_03.ds',...
                '\DS\260208\Raw\ds150148_vladimirDBS_20080226_04.ds',...
                '\DS\260208\Raw\ds150148_vladimirDBS_20080226_05.ds',...
                '\DS\260208\Raw\ds150148_vladimirDBS_20080226_07.ds',...
                '\DS\260208\Raw\ds150148_vladimirDBS_20080226_08.ds',...
                '\DS\260208\Raw\ds150148_vladimirDBS_20080226_09.ds',...
                '\DS\260208\Raw\ds150148_vladimirDBS_20080226_10.ds',...
                '\DS\260208\Raw\ds150148_vladimirDBS_20080226_11.ds'
                };
            sequence = {'SR2', 'CR3', 'R4', 'SR5', 'CR7', 'SL8', 'SL9', 'CL10', 'CL11'};
            root='\DS\260208\';
            details.movthresh = 0.02;
        else
            files={...
                '\DS\250208\Raw\ds150148_vladimirDBS_20080225_01.ds',...
                '\DS\250208\Raw\ds150148_vladimirDBS_20080225_02.ds',...
                '\DS\250208\Raw\ds150148_vladimirDBS_20080225_03.ds',...
                '\DS\250208\Raw\ds150148_vladimirDBS_20080225_04.ds',...
                '\DS\250208\Raw\ds150148_vladimirDBS_20080225_05.ds',...
                '\DS\250208\Raw\ds150148_vladimirDBS_20080225_06.ds',...
                '\DS\250208\Raw\ds150148_vladimirDBS_20080225_07.ds',...
                '\DS\250208\Raw\ds150148_vladimirDBS_20080225_08.ds',...
                '\DS\250208\Raw\ds150148_vladimirDBS_20080225_09.ds'
                };
            sequence = {'SR1', 'SL2', 'CR3', 'CR4', 'CL5', 'SR6', 'R7', 'SL8', 'CL9'};
            root='\DS\250208\';
            details.movthresh = 0.01;
            
            % Left and right were swapped in the recording
            indR   =  spm_match_str(montage.labelnew, {'STN_R01', 'STN_R12', 'STN_R23'});
            indL   =  spm_match_str(montage.labelnew, {'STN_L01', 'STN_L12', 'STN_L23'});
            
            tmp = montage.tra(indR, :);
            montage.tra(indR, :) = montage.tra(indL, :);
            montage.tra(indL, :) = tmp;
        end
        megbad = {'MLO42'};
    case 'WB'
        if on
            files={...
                '\WB\290508\Raw\wb100154_vladimirDBS_20080529_01.ds',...
                '\WB\290508\Raw\wb100154_vladimirDBS_20080529_02.ds',...
                '\WB\290508\Raw\wb100154_vladimirDBS_20080529_03.ds',...
                '\WB\290508\Raw\wb100154_vladimirDBS_20080529_04.ds',...
                '\WB\290508\Raw\wb100154_vladimirDBS_20080529_05.ds',...
                '\WB\290508\Raw\wb100154_vladimirDBS_20080529_06.ds',...
                '\WB\290508\Raw\wb100154_vladimirDBS_20080529_07.ds',...
                '\WB\290508\Raw\wb100154_vladimirDBS_20080529_08.ds',...
                '\WB\290508\Raw\wb100154_vladimirDBS_20080529_09.ds'
                };
            sequence = {'CL1', 'R2', 'CL3', 'SL4', 'CR5', 'CR6', 'SR7', 'SL8', 'SR9'};
            root='\WB\290508\';
            details.movthresh = 0.01;
        else
            files={...
                '\WB\300508\Raw\100154_vladimirDBS_20080530_01.ds',...
                '\WB\300508\Raw\100154_vladimirDBS_20080530_02.ds',...
                '\WB\300508\Raw\100154_vladimirDBS_20080530_03.ds',...
                '\WB\300508\Raw\100154_vladimirDBS_20080530_04.ds',...
                '\WB\300508\Raw\100154_vladimirDBS_20080530_05.ds',...
                '\WB\300508\Raw\100154_vladimirDBS_20080530_06.ds',...
                '\WB\300508\Raw\100154_vladimirDBS_20080530_07.ds',...
                '\WB\300508\Raw\100154_vladimirDBS_20080530_08.ds',...
                '\WB\300508\Raw\100154_vladimirDBS_20080530_09.ds'
                };
            sequence = {'SR1', 'CL2', 'CR3', 'CR4', 'SL5', 'SL6', 'SR7', 'R8', 'CL9'};
            root='\WB\300508\';
            details.movthresh = 0.01;
        end
        megbad = {'MLO42'};
    case 'RP'
        if on
            files={...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_01.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_03.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_04.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_06.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_07.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_08.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_09.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_10.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_11.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_12.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_13.ds',...
                '\RP\060808\Raw\rp191142_vladimirDBS_20080806_14.ds'
                };
            sequence = {'SL1', 'CR3', 'SR4', 'R6', 'SR7', 'SL8', 'CR9', 'CL10', 'CL11', 'SR12', 'CR13', 'SL14', 'CL15'};
            root='\RP\060808\';
            details.movthresh = 0.04;
        end
        megbad = {'MLO42'};
    case 'JB'
        if on
            files={...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_01.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_02.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_03.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_04.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_05.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_06.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_07.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_08.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_09.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_10.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_11.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_12.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_13.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_14.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_15.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_16.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_17.ds', ...
                '\JB\141108\Raw\jb060560_vladimirDBS_20081114_18.ds'
                };
            sequence = {'CL1', 'SR2', 'SR3', 'CR4', 'R5', 'CR6', 'SL7', 'SL8', 'CL9', 'SL10', 'CL11', 'CR12', 'CR13', 'CL14', 'R15', 'SR16', 'SL17', 'SR18'};
            root='\JB\141108\';
            details.movthresh = 0.02;
        else
            files={...
                '\JB\171108\Raw\jb060560_vladimirDBS_20081117_01.ds', ...
                '\JB\171108\Raw\jb060560_vladimirDBS_20081117_02.ds', ...
                '\JB\171108\Raw\jb060560_vladimirDBS_20081117_03.ds', ...
                '\JB\171108\Raw\jb060560_vladimirDBS_20081117_04.ds', ...
                '\JB\171108\Raw\jb060560_vladimirDBS_20081117_05.ds', ...
                '\JB\171108\Raw\jb060560_vladimirDBS_20081117_06.ds', ...
                '\JB\171108\Raw\jb060560_vladimirDBS_20081117_07.ds', ...
                '\JB\171108\Raw\jb06051960_vladimirDBS_20081117_02.ds', ...
                '\JB\171108\Raw\jb06051960_vladimirDBS_20081117_03.ds'
                };
            sequence = {'CL1', 'SL2', 'CR3', 'SR4', 'SR5', 'CR6', 'R7', 'SL8', 'CL9'};
            root= '\JB\171108\';
            details.movthresh = 0.02;
        end
        megbad = {'MLO42'};
    case 'CP'
        if ~on
            files={...
                '\CP\300109\Raw\cp021245_vladimirDBS_20090130_02.ds', ...
                '\CP\300109\Raw\cp021245_vladimirDBS_20090130_03.ds', ...
                '\CP\300109\Raw\cp021245_vladimirDBS_20090130_04.ds', ...
                '\CP\300109\Raw\cp021245_vladimirDBS_20090130_05.ds', ...
                '\CP\300109\Raw\cp021245a_vladimirDBS_20090130_01.ds', ...
                '\CP\300109\Raw\cp021245a_vladimirDBS_20090130_02.ds', ...
                '\CP\300109\Raw\cp021245a_vladimirDBS_20090130_03.ds', ...
                '\CP\300109\Raw\cp021245a_vladimirDBS_20090130_04.ds', ...
                '\CP\300109\Raw\cp021245b_vladimirDBS_20090130_01.ds'
                };
            sequence = {'SL1', 'CL2', 'SR3', 'CR4', 'CL5', 'CR6', 'R7', 'SL8', 'SR9'};
            root='\CP\300108\';
            details.movthresh = 0.01;
        end
        megbad = {'MLO42'};
    case 'JA'
        if on
            files={...
                '\JA\080509\Raw\ja271247_vladimirDBS_20090508_02.ds', ...
                '\JA\080509\Raw\ja271247_vladimirDBS_20090508_03.ds', ...
                '\JA\080509\Raw\ja271247_vladimirDBS_20090508_04.ds', ...
                '\JA\080509\Raw\ja271247_vladimirDBS_20090508_05.ds', ...
                '\JA\080509\Raw\ja271247_vladimirDBS_20090508_06.ds', ...
                '\JA\080509\Raw\ja271247_vladimirDBS_20090508_07.ds', ...
                '\JA\080509\Raw\ja271247_vladimirDBS_20090508_08.ds', ...
                '\JA\080509\Raw\ja271247_vladimirDBS_20090508_09.ds', ...
                '\JA\080509\Raw\ja271247_vladimirDBS_20090508_10.ds'
                };
            sequence = {'SL1', 'R2', 'SL3', 'CR4', 'CL5', 'SR6', 'CR7', 'SR8', 'CL9'};
            root='\JA\080509\';
            details.movthresh = 0.01;
        else
            files={...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_01.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_03.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_04.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_05.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_06.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_07.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_08.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_09.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_10.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_11.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_12.ds', ...
                '\JA\070509\Raw\ja271247_vladimirDBS_20090507_13.ds'
                };
            sequence = {'SR1', 'SL2', 'CL3', 'SL4', 'CL5', 'CR6', 'R7', 'SR8', 'CR9', 'SR10', 'SL11', 'CL12'};
            root='\JA\070509\';
            details.movthresh = 0.01;
            details.lfptocheck = {'STN_R23', 'STN_L01', 'STN_L12', 'STN_L23'};
        end
        megbad = {'MLO42'};
    case 'RL'
        if on
            files={...
                '\RL\180609\Raw\rl120348_vladimirDBS_20090618_01.ds'
                };
            sequence = {'R1'};
            chan= {'PPN_R01', 'PPN_R12', 'PPN_R23'};
            root= '\RL\180609\';
            details.movthresh = 0.01;
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L01', 'STN_L12', 'STN_L23'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'PPN_R01';
            montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'PPN_R12';
            montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'PPN_R23';
            
        end
        megbad = {'MLO42'};
    case 'MC'
        if on
            files={...
                '\MC\250709\Raw\mc140651_vladimirDBS_20090725_02.ds', ...
                '\MC\250709\Raw\mc140651_vladimirDBS_20090725_03.ds', ...
                '\MC\250709\Raw\mc140651_vladimirDBS_20090725_04.ds', ...
                '\MC\250709\Raw\mc140651_vladimirDBS_20090725_05.ds', ...
                '\MC\250709\Raw\mc140651_vladimirDBS_20090725_06.ds', ...
                '\MC\250709\Raw\mc140651_vladimirDBS_20090725_07.ds', ...
                '\MC\250709\Raw\mc140651_vladimirDBS_20090725_08.ds', ...
                '\MC\250709\Raw\mc140651_vladimirDBS_20090725_09.ds', ...
                '\MC\250709\Raw\mc140651_vladimirDBS_20090725_10.ds'
                };
            sequence = {'CL1', 'R2', 'SL3', 'SL4', 'CR5', 'CR6', 'CL7', 'SR8', 'SR9'};
            root='\MC\250709\';
            details.movthresh = 0.01;
        else
            files={...
                '\MC\240709\Raw\mc140651_vladimirDBS_20090724_01.ds', ...
                '\MC\240709\Raw\mc140651_vladimirDBS_20090724_02.ds', ...
                '\MC\240709\Raw\mc140651_vladimirDBS_20090724_03.ds', ...
                '\MC\240709\Raw\mc140651_vladimirDBS_20090724_04.ds', ...
                '\MC\240709\Raw\mc140651_vladimirDBS_20090724_05.ds', ...
                '\MC\240709\Raw\mc140651_vladimirDBS_20090724_06.ds', ...
                '\MC\240709\Raw\mc140651_vladimirDBS_20090724_07.ds', ...
                '\MC\240709\Raw\mc140651_vladimirDBS_20090724_08.ds', ...
                '\MC\240709\Raw\mc140651_vladimirDBS_20090724_09.ds'
                };
            sequence = {'CL1', 'CR2', 'CL3', 'SL4', 'SL5', 'SR6', 'R7', 'CR8', 'SR9'};
            root= '\MC\230709\';
            details.movthresh = 0.01;
        end
        megbad = {'MLO42'};
    case 'JN'
        if on
            files={...
                '\JN\300709\Raw\jn270257_vladimirDBS_20090730_05.ds', ...
                '\JN\300709\Raw\jn270257_vladimirDBS_20090730_07.ds', ...
                '\JN\300709\Raw\jn270257_vladimirDBS_20090730_08.ds', ...
                '\JN\300709\Raw\jn270257_vladimirDBS_20090730_10.ds', ...
                '\JN\300709\Raw\jn270257_vladimirDBS_20090730_11.ds', ...
                '\JN\300709\Raw\jn270257_vladimirDBS_20090730_01.ds', ...
                '\JN\300709\Raw\jn270257_vladimirDBS_20090730_02.ds', ...
                '\JN\300709\Raw\jn270257_vladimirDBS_20090730_03.ds', ...
                '\JN\300709\Raw\jn270257_vladimirDBS_20090730_04.ds', ...
                };
            sequence = {'CR1', 'SR2', 'SR3', 'CL4', 'CR5', 'SL6', 'R7', 'CL8', 'SL9'};
            root='\JN\300709\';
            details.movthresh = 0.01;
        else
            files={...
                '\JN\310709\Raw\jn270257_vladimirDBS_20090731_01.ds', ...
                '\JN\310709\Raw\jn270257_vladimirDBS_20090731_02.ds', ...
                '\JN\310709\Raw\jn270257_vladimirDBS_20090731_03.ds', ...
                '\JN\310709\Raw\jn270257_vladimirDBS_20090731_04.ds', ...
                '\JN\310709\Raw\jn270257_vladimirDBS_20090731_05.ds', ...
                '\JN\310709\Raw\jn270257_vladimirDBS_20090731_06.ds', ...
                '\JN\310709\Raw\jn270257_vladimirDBS_20090731_07.ds', ...
                '\JN\310709\Raw\jn270257_vladimirDBS_20090731_09.ds', ...
                '\JN\310709\Raw\jn270257_vladimirDBS_20090731_10.ds'
                };
            sequence = {'R1', 'SL2', 'SR3', 'SL4', 'CR5', 'SR6', 'CL7', 'CL8', 'CR9'};
            root= '\JN\310709\';
            details.movthresh = 0.01;
            details.lfpthresh = 40;
        end
        megbad = {'MLO42'};
    case 'DF'
        if on
            files={...
                '\DF\060809\Raw\df140551_vladimirDBS_20090806_01.ds', ...
                '\DF\060809\Raw\df140551_vladimirDBS_20090806_02.ds', ...
                '\DF\060809\Raw\df140551_vladimirDBS_20090806_03.ds', ...
                '\DF\060809\Raw\df140551_vladimirDBS_20090806_04.ds', ...
                '\DF\060809\Raw\df140551_vladimirDBS_20090806_05.ds', ...
                '\DF\060809\Raw\df140551_vladimirDBS_20090806_06.ds', ...
                '\DF\060809\Raw\df140551_vladimirDBS_20090806_07.ds', ...
                '\DF\060809\Raw\df140551_vladimirDBS_20090806_08.ds', ...
                '\DF\060809\Raw\df140551_vladimirDBS_20090806_09.ds'
                };
            sequence = {'SR1', 'CL2', 'SR3', 'SL4', 'CR5', 'CR6', 'CL7', 'R8', 'SL9'};
            root='\DF\060809\';
            details.movthresh = 0.01;
        else
            files={...
                '\DF\070809\Raw\df140551_vladimirDBS_20090807_01.ds', ...
                '\DF\070809\Raw\df140551_vladimirDBS_20090807_02.ds', ...
                '\DF\070809\Raw\df140551_vladimirDBS_20090807_03.ds', ...
                '\DF\070809\Raw\df140551_vladimirDBS_20090807_04.ds', ...
                '\DF\070809\Raw\df140551_vladimirDBS_20090807_05.ds', ...
                '\DF\070809\Raw\df140551_vladimirDBS_20090807_06.ds', ...
                '\DF\070809\Raw\df140551_vladimirDBS_20090807_07.ds', ...
                '\DF\070809\Raw\df140551_vladimirDBS_20090807_08.ds', ...
                '\DF\070809\Raw\df140551_vladimirDBS_20090807_09.ds'
                };
            sequence = {'CL1', 'CR2', 'SR3', 'CL4', 'SR5', 'CR6', 'SL7', 'R8', 'SL9'};
            root= '\DF\070809\';
            details.movthresh = 0.01;
        end
        megbad = {'MLO42'};
    case 'DP'
        if on
            files={...
                '\DP\270809\Raw\dp190452_vladimirDBS_20090827_01.ds', ...
                '\DP\270809\Raw\dp190452_vladimirDBS_20090827_02.ds', ...
                '\DP\270809\Raw\dp190452_vladimirDBS_20090827_03.ds', ...
                '\DP\270809\Raw\dp190452_vladimirDBS_20090827_04.ds', ...
                '\DP\270809\Raw\dp190452_vladimirDBS_20090827_05.ds', ...
                '\DP\270809\Raw\dp190452_vladimirDBS_20090827_06.ds', ...
                '\DP\270809\Raw\dp190452_vladimirDBS_20090827_07.ds', ...
                '\DP\270809\Raw\dp190452_vladimirDBS_20090827_08.ds', ...
                '\DP\270809\Raw\dp190452_vladimirDBS_20090827_09.ds'
                };
            sequence = {'SL1', 'CL2', 'CR3', 'SL4', 'CL5', 'SR6', 'R7', 'SR8', 'CR9'};
            root='\DP\270809\';
            details.movthresh = 0.01;
        else
            files={...
                '\DP\280809\Raw\dp190452_vladimirDBS_20090828_01.ds', ...
                '\DP\280809\Raw\dp190452_vladimirDBS_20090828_02.ds', ...
                '\DP\280809\Raw\dp190452_vladimirDBS_20090828_03.ds', ...
                '\DP\280809\Raw\dp190452_vladimirDBS_20090828_04.ds', ...
                '\DP\280809\Raw\dp190452_vladimirDBS_20090828_05.ds', ...
                '\DP\280809\Raw\dp190452_vladimirDBS_20090828_06.ds', ...
                '\DP\280809\Raw\dp190452_vladimirDBS_20090828_07.ds', ...
                '\DP\280809\Raw\dp190452_vladimirDBS_20090828_08.ds', ...
                '\DP\280809\Raw\dp190452_vladimirDBS_20090828_09.ds'
                };
            sequence = {'SR1', 'CL2', 'CL3', 'SL4', 'CR5', 'SR6', 'R7', 'CR8', 'SL9'};
            root= '\DP\280809\';
            details.movthresh = 0.01;
        end
        megbad = {'MLO42'};
    case 'TB'
        if on
        else
            files = {...
                '\TB\090608\Raw\tb281158_vladimirDBS_20080609_01.ds',...
                '\TB\090608\Raw\tb281158_vladimirDBS_20080609_02.ds',...
                '\TB\090608\Raw\tb281158_vladimirDBS_20080609_03.ds',...
                '\TB\090608\Raw\tb281158_vladimirDBS_20080609_04.ds',...
                '\TB\090608\Raw\tb281148_vladimirDBS_20080609_06.ds',...
                '\TB\090608\Raw\tb281148_vladimirDBS_20080609_02.ds'};
            sequence = {'R', 'SL', 'RC', 'SL', 'STIM', 'RC'};
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L01', 'STN_L12', 'STN_L23'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
            montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
            montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
            
            details.lfpthresh = 1e-4;
            root='\TB\090608\';
            
            chan = {'LFP_R01', 'LFP_R12', 'LFP_R23'};
        end
        megbad = {'MLO42'};
    case 'LN01'
        if on
            files = {
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_01.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_02.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_03.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_04.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_05.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_06.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_07.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_08.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_09.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_10.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_11.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_12.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_13.ds', ...
                'LN01\180110\Raw\cc230656_vladimirDBS_20100118_14.ds'
                };
            root = 'LN01\180110\';
            sequence =  {'R1', 'SM1', 'SM2', 'SM3', 'SM4',  'SM5', 'SM6', 'SM7', 'SM8', 'R2', 'SR', 'SL', 'SR', 'SL'};
        else
            files  = {
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_01.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_02.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_03.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_04.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_05.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_06.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_07.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_08.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_09.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_10.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_11.ds', ...
                'LN01\150110\Raw\cc230656_vladimirDBS_20100115_12.ds'
                };
            root = 'LN01\150110\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4',  'SM5', 'SM6', 'SM7', 'SM8', 'R2', 'SL', 'SR'};
        end
        megbad = {'MLO42'};
    case 'LN02'
        if on
            files = {
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_01.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_02.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_03.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_04.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_05.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_06.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_07.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_08.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_09.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_10.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_11.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_13.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_14.ds', ...
                '\LN02\110310\Raw\mn010849_vladimirDBS_20100311_15.ds'
                };
            root = 'LN02\110310\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4',  'SM5', 'SM6', 'SM7', 'SM8', 'R2', 'SR', 'SL', 'SR', 'SL'};
        else
            %  'LN02\120310\Raw\mn010849_vladimirDBS_20100312_09.ds', ...'SM8',
            files = {
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_01.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_02.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_03.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_04.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_05.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_06.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_07.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_08.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_10.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_11.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_12.ds', ...
                'LN02\120310\Raw\mn010849_vladimirDBS_20100312_13.ds'
                };
            root = 'LN02\120310\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4',  'SM5', 'SM6', 'SM7', 'R2', 'SR', 'SR', 'SL', 'SL'};
        end
        megbad = {'MLO42'};
    case 'LN03'
        if on
            files = {
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_01.ds', ...
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_02.ds', ...
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_03.ds', ...
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_04.ds', ...
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_05.ds', ...
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_06.ds', ...
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_07.ds', ...
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_08.ds', ...
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_09.ds', ...
                'LN03\080410\Raw\pg210956_vladimirDBS_20100408_10.ds'
                };
            root = 'LN03\080410\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4',  'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
        else
            files = {
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_01.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_02.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_03.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_04.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_05.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_06.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_07.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_08.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_09.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_10.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_11.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_12.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_13.ds', ...
                'LN03\090410\Raw\pg210956_vladimirDBS_20100409_14.ds'
                };
            root =  'LN03\090410\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SL', 'SL', 'SR', 'SR', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
        end
        megbad = {'MLO42'};
    case 'LN04'
        if on
        else
            files = {...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_01.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_02.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_03.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_04.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_05.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_06.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_07.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_08.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_09.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_10.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_11.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_12.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_13.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_14.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_15.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_16.ds',...
                '\LN04\280510\Raw\LN04171149_vladimirDBS_20100528_17.ds'};
            sequence = {'R', 'RT', 'RT', 'RT', 'RT', 'RT', 'R',...
                'SL', 'CL', 'SL', 'CL', 'SL', 'CL', 'SL', 'CL', 'SL', 'CL',};
            details.lfpthresh = 15;
            root= '\LN04\280510\';
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L12'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
            montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
            montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
            
            montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'EMG_FA_R';
            montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'EMG_FA_L';
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23'};
        megbad = {'MLO42'};
    case 'LN05'
        if on
            files = {
                '\LN05\170610\Raw\LN05260755_vladimirDBS_20100617_01.ds', ...
                '\LN05\170610\Raw\LN05260755_vladimirDBS_20100617_02.ds', ...
                '\LN05\170610\Raw\LN05260755_vladimirDBS_20100617_03.ds', ...
                '\LN05\170610\Raw\LN05260755_vladimirDBS_20100617_04.ds', ...
                '\LN05\170610\Raw\LN05260755_vladimirDBS_20100617_05.ds', ...
                '\LN05\170610\Raw\LN05260755_vladimirDBS_20100617_06.ds'
                };
            root =  '\LN05\170610\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'R2'};
        end
        megbad = {'MLO42'};
    case 'LN06'
        if on
            files = {
                'LN06\111110\Raw\LN06080752_brainampDBS_20101111_01.ds', ...
                'LN06\111110\Raw\LN06080752_brainampDBS_20101111_02.ds', ...
                'LN06\111110\Raw\LN06080752_brainampDBS_20101111_03.ds', ...
                'LN06\111110\Raw\LN06080752_brainampDBS_20101111_04.ds', ...
                'LN06\111110\Raw\LN06080752_brainampDBS_20101111_05.ds', ...
                'LN06\111110\Raw\LN06080752_brainampDBS_20101111_06.ds'
                };
            root = 'LN06\111110\';
            sequence  = {'R1', 'R2', 'SM1', 'SM2', 'SM3', 'SM4'};
            details.fiducials = fullfile(dbsroot, initials, 'MRI', 'LN06_smri_fid_on.txt');
        else
            files = {
                'LN06\121110\Raw\LN06080752_brainampDBS_20101112_01.ds', ...
                'LN06\121110\Raw\LN06080752_brainampDBS_20101112_02.ds', ...
                'LN06\121110\Raw\LN06080752_brainampDBS_20101112_03.ds', ...
                'LN06\121110\Raw\LN06080752_brainampDBS_20101112_04.ds', ...
                'LN06\121110\Raw\LN06080752_brainampDBS_20101112_05.ds', ...
                };
            root = 'LN06\121110\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4'};
            details.fiducials = fullfile(dbsroot, initials, 'MRI', 'LN06_smri_fid_off.txt');
        end
        details.lfpthresh = 7e7;
        details.brainamp = 1;
        megbad = {'MLO42'};
    case 'LN07'
        if on
            files = {
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_01.ds', ...
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_02.ds', ...
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_03.ds', ...
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_04.ds', ...
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_05.ds', ...
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_06.ds', ...
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_07.ds', ...
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_08.ds', ...
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_09.ds', ...
                'LN07\130111\Raw\LN07041164_brainampDBS_20110113_10.ds'
                };
            root = 'LN07\130111\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
            details.fiducials = fullfile(dbsroot, initials, 'MRI', 'LN07_smri_fid_on.txt');
        else
            files = {
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_01.ds', ...
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_02.ds', ...
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_03.ds', ...
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_04.ds', ...
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_05.ds', ...
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_06.ds', ...
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_07.ds', ...
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_08.ds', ...
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_09.ds', ...
                'LN07\140111\Raw\LN07041164_brainampDBS_20110114_10.ds'
                };
            root = 'LN07\140111\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
            details.fiducials = fullfile(dbsroot, initials, 'MRI', 'LN07_smri_fid_off.txt');
        end
        megbad = {'MLO42'};
        details.lfpthresh = 7e7;
        details.brainamp = 1;
    case 'LN08'
        if on
        else
            files = {
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_01.ds', ...
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_02.ds', ...
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_03.ds', ...
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_04.ds', ...
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_05.ds', ...
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_06.ds', ...
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_07.ds', ...
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_08.ds', ...
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_09.ds', ...
                'LN08\070211\Raw\ds011054_brainampDBS_20110207_10.ds'
                };
            root = 'LN08\070211\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
        end
        details.lfpthresh = 7e7;
        details.brainamp = 1;
        megbad = {'MLO42'};
    case 'LN09'
        if on
            files = {
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_01.ds', ...
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_02.ds', ...
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_03.ds', ...
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_04.ds', ...
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_05.ds', ...
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_06.ds', ...
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_07.ds', ...
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_08.ds', ...
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_09.ds', ...
                'LN09\241011\Raw\ln09070551_brainampDBS_20110224_10.ds'
                };
            root = 'LN09\241011\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
        else
            files = {
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_01.ds', ...
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_02.ds', ...
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_03.ds', ...
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_04.ds', ...
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_05.ds', ...
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_06.ds', ...
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_07.ds', ...
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_08.ds', ...
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_09.ds', ...
                'LN09\251011\Raw\ln09070551_brainampDBS_20110225_10.ds'
                };
            root = 'LN09\251011\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
        end
        details.lfpthresh = 7e7;
        details.brainamp = 1;
        megbad = {'MLO42'};
    case 'LN10'
        if on
            files = {
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_08.ds', ...
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_09.ds', ...
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_10.ds', ...
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_11.ds'
                };
            root = 'LN10\250311pm\';
            sequence  = {'R1', 'R2', 'SM1', 'SM2'};
        else
            files = {
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_01.ds', ...
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_02.ds', ...
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_03.ds', ...
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_04.ds', ...
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_05.ds', ...
                'LN10\250311\Raw\LN10130343_brainampDBS_20110325_07.ds'
                };
            root = 'LN10\250311am\';
            sequence  = {'R1', 'R2', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5'};
        end
        details.lfpthresh = 7e7;
        details.brainamp = 1;
        
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'PPN_R01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'PPN_R12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'PPN_R23';
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'PPN_L01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'PPN_L12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'PPN_L23';
        
        chan = {'PPN_R01', 'PPN_R12', 'PPN_R23', 'PPN_L01', 'PPN_L12', 'PPN_L23'};
        megbad = {'MLO42'};
    case 'LN11'
        if on
        else
            files = {
                'LN11\280311\Raw\ln11151151_brainampDBS_20110328_01.ds', ...
                'LN11\280311\Raw\ln11151151_brainampDBS_20110328_02.ds', ...
                'LN11\280311\Raw\ln11151151_brainampDBS_20110328_03.ds', ...
                'LN11\280311\Raw\ln11151151_brainampDBS_20110328_04.ds', ...
                'LN11\280311\Raw\ln11151151_brainampDBS_20110328_05.ds', ...
                'LN11\280311\Raw\ln11151151_brainampDBS_20110328_06.ds'
                };
            root = 'LN11\280311\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'R2'};
        end
        details.lfpthresh = 7e7;
        details.brainamp = 1;
        megbad = {'MLO42'};
    case 'LN12'
        if on
            files = {...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_09.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_10.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_11.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_12.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_13.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_14.ds'
                };
            sequence = {'R1', 'R2', 'T1', 'SLEEP', 'SLEEP', 'SLEEP'};
            root = '\LN12\010411pm\';
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L12'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'EMG_TBA_R';
            montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'EMG_TBA_L';
        else
            files = {...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_01.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_02.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_03.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_04.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_05.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_06.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_07.ds',...
                '\LN12\010411\Raw\LN12240649_brainampDBS_20110401_08.ds'
                };
            sequence = {'R1', 'T1', 'NOTRIGSL', 'SL1',  'R2', 'R3', 'SLEEP', 'SLEEP'};
            root= '\LN12\010411am';
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L01', 'STN_L12', 'STN_L23'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
        end
        details.lfpthresh = 60;
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23'};
        details.brainamp = 1;
        megbad = {'MLO42'};
    case 'LN13'
        if on
            files = {...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_01.ds', ...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_02.ds', ...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_03.ds', ...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_04.ds', ...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_05.ds', ...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_06.ds', ...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_07.ds', ...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_08.ds', ...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_09.ds', ...
                'LN13\270611\Raw\LN13030253_brainampDBS_20110627_10.ds'
                };
            root = 'LN13\270611\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
        end
        details.lfpthresh = 7e7;
        details.brainamp = 1;
        megbad = {'MLO42'};
    case 'LN14'
        if on
        else
            files = {...
                '\LN14\120811\Raw\LN14010749_brainampDBS_20110812_01.ds',...
                '\LN14\120811\Raw\LN14010749_brainampDBS_20110812_02.ds',...
                '\LN14\120811\Raw\LN14010749_brainampDBS_20110812_03.ds',...
                '\LN14\120811\Raw\LN14010749_brainampDBS_20110812_04.ds',...
                '\LN14\120811\Raw\LN14010749_brainampDBS_20110812_05.ds',...
                '\LN14\120811\Raw\LN14010749_brainampDBS_20110812_06.ds',...
                '\LN14\120811\Raw\LN14010749_brainampDBS_20110812_07.ds',...
                };
            sequence = {'R', 'T', 'SR', 'SR',  'T', 'SR', 'SR'};
            details.lfpthresh = 1.5e8;
            details.brainamp = 1;
            root= '\LN14\120811\';
            
            ind   =  spm_match_str(montage.labelnew, {'STN_R12', 'STN_R23'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'EMG_TBA_R';
            
            chan = {'STN_L01', 'STN_L12', 'STN_L23'};
        end
        megbad = {'MLO42'};
    case 'LN15'
        if on
        else
            files = {...
                '\LN15\171011\Raw\LN15ac090671_brainampDBS_20111017_01.ds', ...
                '\LN15\171011\Raw\LN15090671a_brainampDBS_20111017_01.ds', ...
                '\LN15\171011\Raw\LN15090671a_brainampDBS_20111017_02.ds'
                };
            root = '\LN15\171011\';
            sequence = {'R1', 'R2', 'SLEEP'};
            
            details.lfpthresh = 1.5e8;
            details.brainamp = 1;
            
            ind   =  spm_match_str(montage.labelnew, {'STN_R01', 'STN_R12', 'STN_R23'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'LFP_L01';
            montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'LFP_L12';
            montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'LFP_L23';
            
            chan = {'LFP_L01', 'LFP_L12', 'LFP_L23'};
        end
        megbad = {'MLO42'};
    case 'LN16'
        if on
        else
            files = {...
                '\LN16\111111\Raw\LN16270752_brainampDBS_20111111_01.ds',...
                '\LN16\111111\Raw\LN16270752_brainampDBS_20111111_02.ds',...
                '\LN16\111111\Raw\LN16270752_brainampDBS_20111111_04.ds',...
                '\LN16\111111\Raw\LN16270752_brainampDBS_20111111_05.ds',...
                '\LN16\111111\Raw\LN16270752_brainampDBS_20111111_06.ds',...
                '\LN16\111111\Raw\LN16270752_brainampDBS_20111111_07.ds',...
                '\LN16\111111\Raw\LN16270752_brainampDBS_20111111_08.ds',...
                '\LN16\111111\Raw\LN16270752_brainampDBS_20111111_09.ds',...
                };
            sequence = {'R', 'T', 'SL', 'SL',  'T', 'SL', 'SL', 'SLEEP'};
            details.lfpthresh = 2.5e7;
            details.brainamp = 1;
            root= '\LN16\111111\';
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L12', 'STN_L23'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L01'});
            montage.labelnew{ind} = 'Fz';
            montage.tra(ind, strmatch('EEG005', montage.labelorg))  = 0;
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
            montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
            montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
            
            chan = {'LFP_R01', 'LFP_R12', 'LFP_R23'};
        end
        megbad = {'MLO42'};
    case 'LN17'
        if on
        else
            files = {...
                '\LN17\290112\Raw\LN17090938_brainampDBS_20120129_01.ds',...
                '\LN17\290112\Raw\LN17090938_brainampDBS_20120129_02.ds',...
                '\LN17\290112\Raw\LN17090938_brainampDBS_20120129_03.ds',...
                '\LN17\290112\Raw\LN17090938_brainampDBS_20120129_04.ds',...
                '\LN17\290112\Raw\LN17090938_brainampDBS_20120129_05.ds',...
                '\LN17\290112\Raw\LN17090938_brainampDBS_20120129_06.ds',...
                };
            sequence = {'R', 'T', 'R', 'T', 'SQ', 'SLEEP'};
            details.lfpthresh = 1.3e8;
            root= '\LN17\290112\';
            details.brainamp = 1;
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L12'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L01'});
            montage.labelnew{ind} = 'Fz';
            montage.tra(ind, strmatch('EEG005', montage.labelorg))  = 0;
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
            montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
            montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
            
            montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'EMG_FA_R';
            
            chan = {'LFP_R01', 'LFP_R12', 'LFP_R23'};
        end
        megbad = {'MLO42'};
    case 'LN18'
        if on
            files = {...
                'LN18\290112\Raw\LN18120662_brainampDBS_20120129_01.ds', ...
                'LN18\290112\Raw\LN18120662_brainampDBS_20120129_02.ds', ...
                'LN18\290112\Raw\LN18120662_brainampDBS_20120129_03.ds', ...
                'LN18\290112\Raw\LN18120662_brainampDBS_20120129_04.ds', ...
                'LN18\290112\Raw\LN18120662_brainampDBS_20120129_05.ds', ...
                'LN18\290112\Raw\LN18120662_brainampDBS_20120129_06.ds', ...
                'LN18\290112\Raw\LN18120662_brainampDBS_20120129_07.ds', ...
                'LN18\290112\Raw\LN18120662_brainampDBS_20120129_08.ds', ...
                'LN18\290112\Raw\LN18120662_brainampDBS_20120129_09.ds'
                };
            root = 'LN18\290112';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'R2', 'SQ1', 'SQ2'};
            details.lfpthresh = 7e7;
            details.brainamp = 1;
        end
        megbad = {'MLO42'};
    case 'LN19'
        if on
        else
            files = {...
                '\LN19\030512\Raw\LN19010781_brainampDBS_20120503_01.ds',...
                '\LN19\030512\Raw\LN19010781_brainampDBS_20120503_02.ds',...
                '\LN19\030512\Raw\LN19010781_brainampDBS_20120503_03.ds',...
                '\LN19\030512\Raw\LN19010781_brainampDBS_20120503_04.ds',...
                '\LN19\030512\Raw\LN19010781_brainampDBS_20120503_05.ds',...
                '\LN19\030512\Raw\LN19010781_brainampDBS_20120503_06.ds'};
            sequence = {'R', 'T', 'TL', 'R', 'T', 'TL'};
            details.lfpthresh = 2.5e7;
            details.brainamp  = 1;
            
            root= '\LN19\030512\';
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L23'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L01'});
            montage.labelnew{ind} = 'Fz';
            montage.tra(ind, strmatch('EEG005', montage.labelorg))  = 0;
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L12'});
            montage.labelnew{ind} = 'EMG_FA_L';
            montage.tra(ind, strmatch('EEG005', montage.labelorg))  = 1;
            montage.tra(ind, strmatch('EEG006', montage.labelorg))  = 0;
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
            montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
            montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
            
            chan = {'LFP_R01', 'LFP_R12', 'LFP_R23'};
        end
        megbad = {'MLO42'};
    case 'LN20'
        if on
        else
            files = {...
                '\LN20\310512\Raw\LN2031121948_brainampDBS_20120531_01.ds',...
                '\LN20\310512\Raw\LN2031121948_brainampDBS_20120531_02.ds',...
                '\LN20\310512\Raw\LN2031121948_brainampDBS_20120531_03.ds',...
                '\LN20\310512\Raw\LN2031121948_brainampDBS_20120531_04.ds'};
            sequence = {'R', 'T', 'T', 'R'};
            details.lfpthresh = 2.5e7;
            details.brainamp = 1;
            root= '\LN20\310512\';
            
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L12', 'STN_L23'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            ind   =  spm_match_str(montage.labelnew, {'STN_L01'});
            montage.labelnew{ind} = 'Fz';
            montage.tra(ind, strmatch('EEG005', montage.labelorg))  = 0;
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_L01';
            montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_L12';
            montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_L23';
            
            chan = {'LFP_L01', 'LFP_L12', 'LFP_L23'};
            
        end
        megbad = {'MLO42'};
    case 'OX01'
        if on
            files = {
                '\OX01\200410\Raw\ox01_on_rest1raw.fif',...
                '\OX01\200410\Raw\ox01_on_sm1raw.fif',...
                '\OX01\200410\Raw\oxo1_on_sm2raw.fif',...
                '\OX01\200410\Raw\ox01_on_sm3raw.fif',...
                '\OX01\200410\Raw\ox01_on_sm4raw.fif',...
                '\OX01\200410\Raw\ox01_on_sm5raw.fif',...
                '\OX01\200410\Raw\ox01_on_sm6raw.fif',...
                '\OX01\200410\Raw\ox01_on_sm7raw.fif',...
                '\OX01\200410\Raw\ox01_on_sm8raw.fif',...
                '\OX01\200410\Raw\ox01_on_rest2raw.fif'
                };
            root = 'OX01\200410\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
        else
            files = {
                '\OX01\190410\Raw\ox01_off_rest1raw.fif',...
                '\OX01\190410\Raw\ox01_off_sm1raw.fif',...
                '\OX01\190410\Raw\ox01_off_sm2raw.fif',...
                '\OX01\190410\Raw\ox01_off_sm3raw.fif',...
                '\OX01\190410\Raw\ox01_off_sm4raw.fif',...
                '\OX01\190410\Raw\ox01_off_sm5raw.fif',...
                '\OX01\190410\Raw\ox01_off_sm6raw.fif',...
                '\OX01\190410\Raw\ox01_off_sm7raw.fif',...
                '\OX01\190410\Raw\ox01_off_sm8raw.fif'
                };
            root = 'OX01\190410\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8'};
            
            % Only 2 LFP channels were recorded
            ind   =  spm_match_str(montage.labelnew, setdiff(chan, {'STN_R12', 'STN_L23'}));
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            ind =  spm_match_str(montage.labelnew, {'STN_R12', 'STN_L23'});
            
            montage.tra(ind, :)  = 0;
            
            montage.tra(ind(1), strmatch('MISC001', montage.labelorg)) = 1;
            montage.tra(ind(2), strmatch('MISC002', montage.labelorg)) = 1;
            
        end
        
        chan = {'STN_R12', 'STN_L23'};
        details.lfpthresh = 2e6;
    case 'OX02'
        if on
        else
            files = {
                '\OX02\260410\Raw\ox02_off_rest1raw.fif',...
                '\OX02\260410\Raw\ox02_off_sm1raw.fif', ...
                '\OX02\260410\Raw\ox02_off_sm2raw.fif', ...
                '\OX02\260410\Raw\ox02_off_sm3raw.fif'
                };
            root = fullfile('OX02\260410\');
            sequence  = {'R1', 'SM1', 'SM2', 'SM3'};
        end
    case 'OX03'
        if on
            files = {
                '\OX03\120710pm\Raw\ox03_on_rest1raw.fif',...
                '\OX03\120710pm\Raw\ox03_on_rest2raw.fif'
                };
            root = fullfile('OX03\120710pm\');
            sequence = {'R1', 'R2'};
        else
            files = {
                '\OX03\120710am\Raw\ox03_off_rest1raw.fif', ...
                '\OX03\120710am\Raw\ox03_off_sm1raw.fif', ...
                '\OX03\120710am\Raw\ox03_OFF_SM2raw.fif', ...
                '\OX03\120710am\Raw\ox03_off_sm3raw.fif', ...
                '\OX03\120710am\Raw\ox03_off_sm4raw.fif', ...
                '\OX03\120710am\Raw\ox03_off_sm5raw.fif', ...
                '\OX03\120710am\Raw\ox3_off_sm6raw.fif', ...
                '\OX03\120710am\Raw\ox03_off_sm7raw.fif', ...
                '\OX03\120710am\Raw\ox03_off_sm8raw.fif', ...
                '\OX03\120710am\Raw\ox03_off_rest2raw.fif'
                };
            root = fullfile('OX03\120710am\');
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
            
            % Left and right were swapped in the recording
            indR   =  spm_match_str(montage.labelnew, {'STN_R01', 'STN_R12', 'STN_R23'});
            indL   =  spm_match_str(montage.labelnew, {'STN_L01', 'STN_L12', 'STN_L23'});
            
            tmp = montage.tra(indR, :);
            montage.tra(indR, :) = montage.tra(indL, :);
            montage.tra(indL, :) = tmp;
        end
        details.lfpthresh = 3e6;
        details.lfptocheck = setdiff(chan, 'STN_L23');
    case 'OX04'
        if on
            %  '\OX04\200710\Raw\ox04_on_sm2raw.fif', ...
            files = {
                '\OX04\200710\Raw\ox04_on_restraw1.fif', ...
                '\OX04\200710\Raw\ox04_on_sm1raw.fif', ...
                '\OX04\200710\Raw\ox04_on_sm3raw.fif', ...
                '\OX04\200710\Raw\ox04_on_sm4raw.fif', ...
                '\OX04\200710\Raw\ox04_on_sm05raw.fif', ...
                '\OX04\200710\Raw\ox04_on_sm06raw.fif', ...
                '\OX04\200710\Raw\ox04_on_sm07raw.fif', ...
                '\OX04\200710\Raw\ox04_on_sm8raw.fif', ...
                '\OX04\200710\Raw\ox04_on_restraw2.fif'
                };
            root = '\OX04\200710';
            sequence = {'R1', 'SM1', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};%'SM2',
        else
            files = {
                '\OX04\190710\Raw\ox04_off_rest1raw.fif', ...
                '\OX04\190710\Raw\ox04_off_sm1raw.fif', ...
                '\OX04\190710\Raw\ox04_off_sm2raw.fif', ...
                '\OX04\190710\Raw\ox04_off_sm3raw.fif', ...
                '\OX04\190710\Raw\ox04_raw_sm4raw.fif', ...
                '\OX04\190710\Raw\ox04_off_sm5raw.fif', ...
                '\OX04\190710\Raw\ox04_off_sm6raw.fif', ...
                '\OX04\190710\Raw\ox04_off_sm7raw.fif', ...
                '\OX04\190710\Raw\ox04_off_sm8raw.fif', ...
                '\OX04\190710\Raw\ox04_off_smov1.fif', ...
                '\OX04\190710\Raw\ox04_off_smov2raw.fif', ...
                '\OX04\190710\Raw\ox04_off_smov3raw.fif', ...
                '\OX04\190710\Raw\ox04_off_smov4raw.fif'
                };
            root = '\OX04\190710';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2', 'SL1', 'SR1', 'SL2', 'SR2'};
        end
        details.lfpthresh = 2.5e6;
    case 'OX05'
        if on
        else
            files = {
                '\OX05\310810\Raw\ox05_stim_130hz_handsout_1raw.fif',...
                '\OX05\310810\Raw\ox05_stim_10hz_handsout_1raw.fif',...
                '\OX05\310810\Raw\ox05_handsout_1raw.fif',...
                '\OX05\310810\Raw\ox05_stimcomson_L02_130hz_3v_handsout_1raw.fif',...
                '\OX05\310810\Raw\ox05_stimcomson_L13_130hz_3v_handsout_1raw.fif',...
                '\OX05\310810\Raw\ox05_stimcomson_r02_130hz_3v_handsout_1raw.fif',...
                '\OX05\310810\Raw\ox05_stimcomson_r13_130hz_3v_handsout_1raw.fif',...
                '\OX05\310810\Raw\ox05_stimon_l02_5hz_3p4v_rest_1raw.fif',...
                '\OX05\310810\Raw\ox05_stimon_r02_5hz_3p4v_resrt_1raw.fif'
                };
            root = '\OX05\310810\';
            sequence = {'STIM', 'STIM', 'R', 'STIMREC', 'STIMREC', 'STIMREC', 'STIMREC', 'STIMREC', 'STIMREC'};
            details.badchanthresh = 0.1;
        end
    case 'OX06'
        if on
            files = {
                '\OX06\191010\Raw\ox06_on_rest1raw.fif',...
                '\OX06\191010\Raw\ox06_on_sm1raw.fif',...
                '\OX06\191010\Raw\ox06_on_sm2raw.fif',...
                '\OX06\191010\Raw\ox06_on_sm3raw.fif',...
                '\OX06\191010\Raw\ox06_on_sm4raw.fif',...
                '\OX06\191010\Raw\ox06_on_sm5raw.fif',...
                '\OX06\191010\Raw\ox06_on_sm6raw.fif',...
                '\OX06\191010\Raw\ox06_on_sm7raw.fif',...
                '\OX06\191010\Raw\ox06_on_sm8raw.fif',...
                '\OX06\191010\Raw\ox06_on_rest2raw.fif'
                };
            root = '\OX06\191010\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
            details.badchanthresh = 1;
        else
            files = {
                '\OX06\181010\Raw\ox06_off_rest1raw.fif',...
                '\OX06\181010\Raw\ox06_off_sm1raw.fif',...
                '\OX06\181010\Raw\ox06_off_sm2raw.fif',...
                '\OX06\181010\Raw\ox06_off_sm3raw.fif',...
                '\OX06\181010\Raw\ox06_off_sm4raw.fif',...
                '\OX06\181010\Raw\ox06_off_sm5raw.fif',...
                '\OX06\181010\Raw\ox06_off_sm6raw.fif',...
                '\OX06\181010\Raw\ox06_off_sm7raw.fif',...
                '\OX06\181010\Raw\ox06_off_sm8raw.fif',...
                '\OX06\181010\Raw\ox06_off_rest2raw.fif'
                };
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
            root = '\OX06\181010\';
        end
        % Left and right were swapped in the recording
        indR   =  spm_match_str(montage.labelnew, {'STN_R01', 'STN_R12', 'STN_R23'});
        indL   =  spm_match_str(montage.labelnew, {'STN_L01', 'STN_L12', 'STN_L23'});
        
        tmp = montage.tra(indR, :);
        montage.tra(indR, :) = montage.tra(indL, :);
        montage.tra(indL, :) = tmp;
    case 'OX07'
        if on
            files = {
                '\OX07\151110pm\Raw\ox07_onrest1raw.fif',...
                '\OX07\151110pm\Raw\ox07_onrest2raw.fif'
                };
            sequence = {'R1', 'R2'};
            root = '\OX07\151110pm\';
        else
            files = {
                '\OX07\151110am\Raw\ox07_offrest1raw.fif',...
                '\OX07\151110am\Raw\ox07_offsl1raw.fif',...
                '\OX07\151110am\Raw\ox07_offrest2raw.fif'
                };
            sequence = {'R1', 'SL', 'R2'};
            root = '\OX07\151110am\';
        end
    case 'OX08'
        if on
            files = {
                '\OX08\201110\Raw\s0740_offrest1raw.fif',...
                '\OX08\201110\Raw\s0740_offrest1raw.fif'
                };
            sequence = {'R1', 'R2'};
            root = '\OX08\201110\';
        end
    case 'OX09'
        if on
        else
            files = {
                '\OX09\061210\Raw\ox09_OFF_rest1.fif', ...
                '\OX09\061210\Raw\ox09_OFF_sm1raw.fif',...
                '\OX09\061210\Raw\ox09_OFF_sm2raw.fif',...
                '\OX09\061210\Raw\ox09_OFF_sm3raw.fif',...
                '\OX09\061210\Raw\ox09_OFF_sm4raw.fif',...
                '\OX09\061210\Raw\ox09_OFF_sm5raw.fif',...
                '\OX09\061210\Raw\ox09_OFF_sm6raw.fif',...
                '\OX09\061210\Raw\ox09_OFF_sm7raw.fif',...
                '\OX09\061210\Raw\ox09_OFF_sm8raw.fif',...
                '\OX09\061210\Raw\ox09_OFF_rest2.fif'
                };
            root = '\OX09\061210\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
        end
    case 'OX11'
        if on
            files = {
                '\OX11\140211pm\Raw\OX11_ON_rest1raw.fif',...
                '\OX11\140211pm\Raw\OX11_ON_rest2raw.fif'
                };
            root = '\OX11\140211pm\';
            sequence = {'R1', 'R2'};
        else
            files = {
                '\OX11\140211am\Raw\ox11_off_restraw.fif',...
                '\OX11\140211am\Raw\OX11_OFF_SM1raw.fif',...
                '\OX11\140211am\Raw\OX11_OFF_SM2raw.fif',...
                '\OX11\140211am\Raw\OX11_OFF_SM3raw.fif',...
                '\OX11\140211am\Raw\OX11_OFF_SM4raw.fif',...
                '\OX11\140211am\Raw\OX11_OFF_SM5raw.fif',...
                '\OX11\140211am\Raw\OX11_OFF_SM6raw.fif',...
                '\OX11\140211am\Raw\OX11_OFF_rest2raw.fif'
                };
            root = '\OX11\140211am\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'R2'};
        end
        
        chan={'PPN_R01', 'PPN_R12', 'PPN_R23'};
        
        % Left channels were blank due to broken lead
        ind   =  spm_match_str(montage.labelnew, {'STN_L01', 'STN_L12', 'STN_L23'});
        
        montage.labelnew(ind) = [];
        montage.tra(ind, :)  = [];
        
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'PPN_R01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'PPN_R12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'PPN_R23';
    case 'OX12'
        if on
            files = {
                '\OX12\070311pm\Raw\ox12_on_rest1raw.fif',...
                '\OX12\070311pm\Raw\ox12_on_rest2raw.fif'
                };
            root = '\OX12\070311pm\';
            sequence = {'R1', 'R2'};
        else
            files = {
                '\OX12\070311am\Raw\ox12_off_rest1raw.fif',...
                '\OX12\070311am\Raw\ox12_off_sm1raw.fif',...
                '\OX12\070311am\Raw\ox12_off_sm2raw.fif',...
                '\OX12\070311am\Raw\OX12_OFF_sm3raw.fif',...
                '\OX12\070311am\Raw\ox12_off_sm4raw.fif',...
                '\OX12\070311am\Raw\ox12_off_rest2raw.fif'
                };
            root = '\OX12\070311am\';
            sequence = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'R2'};
        end
        
        % Sides swapped
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'PPN_L01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'PPN_L12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'PPN_L23';
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'PPN_R01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'PPN_R12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'PPN_R23';
        
        chan = {'PPN_R01', 'PPN_R12', 'PPN_R23', 'PPN_L01', 'PPN_L12', 'PPN_L23'};
    case 'OX13'
        if on
            %{
            files = {
                '\OX13\110606pm\Raw\OX13_ON_rest1raw.fif',...
                '\OX13\110606pm\Raw\OX13_ON_SM2raw.fif',...
                '\OX13\110606pm\Raw\ox13_on_sm2raw2.fif',...
                '\OX13\110606pm\Raw\OX13_ON_SM3raw.fif',...
                '\OX13\110606pm\Raw\OX13_ON_SM4raw.fif',...
                '\OX13\110606pm\Raw\OX13_ON_SM5raw.fif',...
                '\OX13\110606pm\Raw\OX13_ON_SM6raw.fif',...
                '\OX13\110606pm\Raw\OX13_ON_SM7raw.fif',...
                '\OX13\110606pm\Raw\OX13_ON_SM8raw.fif',...
                '\OX13\110606pm\Raw\OX13_ON_SM9raw.fif',...
                '\OX13\110606pm\Raw\OX13_ON_sm10raw.fif'
                };
            root = '\OX13\110606pm\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'SM9', 'SM10'};
            %}
        else
            files = {
                '\OX13\110606am\Raw\ox13_off_rest1raw.fif',...
                '\OX13\110606am\Raw\OX13_OFF_SM1raw.fif',...
                '\OX13\110606am\Raw\OX13_OFF_SM2raw.fif',...
                '\OX13\110606am\Raw\OX13_OFF_SM3raw.fif',...
                '\OX13\110606am\Raw\OX13_OFF_SM4raw.fif',...
                '\OX13\110606am\Raw\OX13_OFF_SM5raw.fif',...
                '\OX13\110606am\Raw\OX13_OFF_SM6raw.fif',...
                '\OX13\110606am\Raw\ox13_off_sm7raw.fif',...
                '\OX13\110606am\Raw\ox13_off_sm8raw.fif',...
                '\OX13\110606am\Raw\OX13_OFF_rest2raw.fif'
                };
            root = '\OX13\110606am\';
            sequence  = {'R1', 'SM1', 'SM2', 'SM3', 'SM4', 'SM5', 'SM6', 'SM7', 'SM8', 'R2'};
        end
    case 'OX14'
        if on
        else
            files = {
                '\OX14\150811\Raw\ox14_rest1raw.fif',...
                '\OX14\150811\Raw\ox14_stim_l02_b1raw.fif',...
                '\OX14\150811\Raw\ox14_stim_l02_b2raw.fif'
                };
            root = '\OX14\150811\';
            sequence = {'R', 'STIM_L_0_20', 'STIM_L_130_5'};
            
            % Left implant only
            ind   =  spm_match_str(montage.labelnew, {'STN_L23'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            ind = strmatch('STN_L12', montage.labelnew);
            montage.tra(ind, :)   = 0;
            montage.tra(ind, :)   = 0;
            montage.tra(ind, strmatch('MISC005', montage.labelorg)) = 1;
            montage.labelnew{ind} = 'LFP_STIM';
            
            montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'STIM';
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'STN_L01';
            montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'STN_L12';
            montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'STN_L23';
            
            chan = {'STN_L01', 'STN_L12', 'STN_L23'};
        end
    case 'OX15'
        if on
        else
            files = {
                '\OX15\300512\Raw\ox14_off_rest1raw.fif',...
                '\OX15\300512\Raw\ox14_on_lu35raw.fif',...
                '\OX15\300512\Raw\ox14_on_ll35raw.fif',...
                '\OX15\300512\Raw\ox14_on_ru35raw.fif',...
                '\OX15\300512\Raw\ox14_on_rl35raw.fif'
                };
            
            root = '\OX15\300512\';
            sequence = {'R', 'STIMREC', 'STIMREC', 'STIMREC', 'STIMREC'};
            
            montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'PPN_R01';
            montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'PPN_R12';
            montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'PPN_R23';
            
            montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'PPN_L01';
            montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'PPN_L12';
            montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'PPN_L23';
            
            % Not recorded
            ind   =  spm_match_str(montage.labelnew, {'EMG_R', 'EMG_L', 'HEOG', 'VEOG', 'Cz'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            
            chan = {'PPN_R01', 'PPN_R12', 'PPN_R23', 'PPN_L01', 'PPN_L12', 'PPN_L23'};
        end
    case 'LN_B01'
        if on
            files = {...
                '\LN_B01\170212\Raw\LNB01041156_brainampDBS_20120217_01.ds', ...
                '\LN_B01\170212\Raw\LNB01041156_brainampDBS_20120217_02.ds', ...
                '\LN_B01\170212\Raw\LNB01041156_brainampDBS_20120217_03.ds', ...
                '\LN_B01\170212\Raw\LNB01041156_brainampDBS_20120217_04.ds', ...
                '\LN_B01\170212\Raw\LNB01041156_brainampDBS_20120217_05.ds', ...
                '\LN_B01\170212\Raw\LNB01041156_brainampDBS_20120217_06.ds'
                };
            root = '\LN_B01\170212\';
            sequence = {'R1', 'POSNER', 'POSNER', 'POSNER', 'POSNER', 'POSNER'};
            details.lfpthresh = 1.5e8;
            details.brainamp = 1;
        else
            files = {...
                '\LN_B01\190212\Raw\LNB01041156_brainampDBS_20120219_01.ds', ...
                '\LN_B01\190212\Raw\LNB01041156_brainampDBS_20120219_02.ds', ...
                '\LN_B01\190212\Raw\LNB01041156_brainampDBS_20120219_03.ds', ...
                '\LN_B01\190212\Raw\LNB01041156_brainampDBS_20120219_04.ds', ...
                '\LN_B01\190212\Raw\LNB01041156_brainampDBS_20120219_05.ds', ...
                '\LN_B01\190212\Raw\LNB01041156_brainampDBS_20120219_06.ds'
                };
            root = '\LN_B01\190212\';
            sequence = {'R1', 'POSNER', 'POSNER', 'POSNER', 'POSNER', 'POSNER'};
            details.lfpthresh = 7e7;
            details.brainamp = 1;
        end
        megbad = {'MLO42'};
    case 'LN_B02'
        if on
        else
            files = {...
                '\LN_B02\160312\Raw\LNB02220752_brainampDBS_20120316_01.ds', ...
                '\LN_B02\160312\Raw\LNB02220752_brainampDBS_20120316_02.ds', ...
                '\LN_B02\160312\Raw\LNB02220752_brainampDBS_20120316_03.ds', ...
                '\LN_B02\160312\Raw\LNB02220752_brainampDBS_20120316_04.ds', ...
                '\LN_B02\160312\Raw\LNB02220752_brainampDBS_20120316_05.ds'
                };
            root = '\LN_B02\160312\';
            sequence = {'R1', 'POSNER', 'POSNER', 'POSNER', 'POSNER'};
            details.lfpthresh = 7e7;
            details.brainamp = 1;
        end
        megbad = {'MLO42'};
    case 'LN_B03'
        if on
        else
            files = {...
                '\LN_B03\030512\Raw\LNB03101155_brainampDBS_20120503_01.ds', ...
                '\LN_B03\030512\Raw\LNB03101155_brainampDBS_20120503_02.ds', ...
                '\LN_B03\030512\Raw\LNB03101155_brainampDBS_20120503_03.ds'
                };
            root = '\LN_B03\030512\';
            sequence = {'R1', 'POSNER', 'POSNER', 'POSNER'};
            details.lfpthresh = 7e7;
            details.brainamp = 1;
        end
        megbad = {'MLO42'};
    case 'LN_C01'
        if on
        else
            files = {
                '\LN_C01\051012\Raw\LNC01121059_brainampDBS_20121005_01.ds', ...
                '\LN_C01\051012\Raw\LNC01121059_brainampDBS_20121005_02.ds', ...
                '\LN_C01\051012\Raw\LNC01121059_brainampDBS_20121005_03.ds', ...
                '\LN_C01\051012\Raw\LNC01121059_brainampDBS_20121005_04.ds', ...
                '\LN_C01\051012\Raw\LNC01121059_brainampDBS_20121005_05.ds', ...
                '\LN_C01\051012\Raw\LNC01121059_brainampDBS_20121005_06.ds', ...
                '\LN_C01\051012\Raw\LNC01121059_brainampDBS_20121005_07.ds', ...
                '\LN_C01\051012\Raw\LNC01121059_brainampDBS_20121005_08.ds', ...
                '\LN_C01\051012\Raw\LNC01121059_brainampDBS_20121005_09.ds'
                };
            root =  'LN_C01\051012';
            sequence = {'R', 'STIM_R_0', 'STIM_R_130', 'STIM_R_5', 'STIM_R_20', 'STIM_L_0', ...
                'STIM_L_130', 'STIM_L_5', 'STIM_L_20'};
            details.lfpthresh = 7e7;
            details.brainamp = 1;
            details.stim = 1;
        end
        megbad = {'MLO42'};
    case 'LN_C02'
        if on
        else
            files = {
                '\LN_C02\051112\Raw\LNC02240350_brainampDBS_20121105_01.ds', ...
                '\LN_C02\051112\Raw\LNC02240350_brainampDBS_20121105_02.ds', ...
                '\LN_C02\051112\Raw\LNC02240350_brainampDBS_20121105_03.ds', ...
                '\LN_C02\051112\Raw\LNC02240350_brainampDBS_20121105_04.ds'
                };
            root =  'LN_C02\051012';
            sequence = {'R', 'STIM_R_0_130', 'STIM_R_5_20', 'BAD'};
            montage = [];
            details.lfpthresh = 7e7;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C04'
        if on
            files = {
                '\LN_C04\140113\Raw\LNC04100646_brainampDBS_20130114_01.ds', ...
                '\LN_C04\140113\Raw\LNC04100646_brainampDBS_20130114_02.ds', ...
                '\LN_C04\140113\Raw\LNC04100646_brainampDBS_20130114_03.ds', ...
                '\LN_C04\140113\Raw\LNC04100646_brainampDBS_20130114_04.ds', ...
                '\LN_C04\140113\Raw\LNC04100646_brainampDBS_20130114_05.ds'
                };
            root =  '\LN_C04\140113\';
            sequence = {'R', 'STIM_R_0_130', 'STIM_R_5_20', 'STIM_L_0_130', 'STIM_L_5_20'};
            montage = [];
            details.lfpthresh = 7e7;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C05'
        if on
        else
            files = {
                '\LN_C05\220313\Raw\LNC0531031956_brainampDBS_20130322_01.ds', ...
                '\LN_C05\220313\Raw\LNC0531031956_brainampDBS_20130322_02.ds', ...
                '\LN_C05\220313\Raw\LNC0531031956_brainampDBS_20130322_03.ds', ...
                '\LN_C05\220313\Raw\LNC0531031956_brainampDBS_20130322_04.ds', ...
                '\LN_C05\220313\Raw\LNC0531031956_brainampDBS_20130322_05.ds'
                };
            root =  '\LN_C05\220313\';
            sequence = {'R', 'STIM_R_0_130', 'STIM_R_5_20', 'STIM_L_0_130', 'STIM_L_5_20'};
            montage = [];
            details.lfpthresh = 7e7;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C06'
        if on
        else
            files = {
                '\LN_C06\250413\Raw\LNC06030656_brainampDBS_20130425_01.ds', ...
                '\LN_C06\250413\Raw\LNC06030656_brainampDBS_20130425_02.ds', ...
                '\LN_C06\250413\Raw\LNC06030656_brainampDBS_20130425_03.ds', ...
                '\LN_C06\250413\Raw\LNC06030656_brainampDBS_20130425_04.ds', ...
                '\LN_C06\250413\Raw\LNC06030656_brainampDBS_20130425_05.ds'
                };
            root =  '\LN_C06\250413\';
            sequence = {'R', 'STIM_R_5_20', 'STIM_R_0_130', 'STIM_L_5_20', 'STIM_L_0_130'};
            montage = [];
            details.lfpthresh = 7e7;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C07'
        if on
            files = {...
                '\LN_C07\230513\Raw\LNC07301251_brainampDBS_20130523_01.ds',...
                '\LN_C07\230513\Raw\LNC07301251_brainampDBS_20130523_02.ds',...
                '\LN_C07\230513\Raw\LNC07301251_brainampDBS_20130523_03.ds',...
                '\LN_C07\230513\Raw\LNC07301251_brainampDBS_20130523_04.ds',...
                '\LN_C07\230513\Raw\LNC07301251_brainampDBS_20130523_05.ds'
                };
            sequence = {'R', 'BSTIM_R01_20_130', 'BSTIM_R23_20_130', 'BSTIM_L01_20_130', 'BSTIM_L23_20_130',};
            root = '\LN_C07\230513';
            montage = [];
            details.lfpthresh = 50;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
        details.diagnosis = 'PDD';
    case 'LN_C08'
        if on
            files = {...
                '\LN_C08\240513\Raw\LNC08050346_brainampDBS_20130524_01.ds',...
                '\LN_C08\240513\Raw\LNC08050346_brainampDBS_20130524_02.ds',...
                '\LN_C08\240513\Raw\LNC08050346_brainampDBS_20130524_03.ds',...
                '\LN_C08\240513\Raw\LNC08050346_brainampDBS_20130524_04.ds',...
                '\LN_C08\240513\Raw\LNC08050346_brainampDBS_20130524_05.ds'
                };
            sequence = {'R', 'STIM_R_130_20', 'STIM_R_0_5', 'STIM_L_130_20', 'STIM_L_0_5'};
            root = '\LN_C08\240513\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C09'
        if on
        else
            files = {...
                '\LN_C09\210613\Raw\LNC09270548_brainampDBS_20130621_01.ds',...
                '\LN_C09\210613\Raw\LNC09270548_brainampDBS_20130621_02.ds',...
                '\LN_C09\210613\Raw\LNC09270548_brainampDBS_20130621_03.ds',...
                '\LN_C09\210613\Raw\LNC09270548_brainampDBS_20130621_04.ds',...
                '\LN_C09\210613\Raw\LNC09270548_brainampDBS_20130621_05.ds'
                };
            sequence = {'R', 'STIM_R_130_5', 'STIM_R_20_0', 'STIM_L_130_5', 'STIM_L_20_0'};
            root = '\LN_C09\210613\';
            montage = [];
            details.lfpthresh = 50;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C10'
        if on
        else
            files = {...
                '\LN_C10\270613\Raw\lnc10080970_brainampDBS_20130627_01.ds',...
                '\LN_C10\270613\Raw\lnc10080970_brainampDBS_20130627_02.ds',...
                '\LN_C10\270613\Raw\lnc10080970_brainampDBS_20130627_03.ds',...
                '\LN_C10\270613\Raw\lnc10080970_brainampDBS_20130627_04.ds',...
                '\LN_C10\270613\Raw\lnc10080970_brainampDBS_20130627_05.ds',...
                };
            sequence = {'R', 'STIM_R_5_130', 'STIM_R_20_0', 'STIM_L_5_130', 'STIM_L_20_0'};
            root = '\LN_C10\270613';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C11'
        if on
            files = {...
                '\LN_C11\180913\Raw\LNC011ON_brainampDBS_20130918_01.ds',...
                '\LN_C11\180913\Raw\LNC011ON_brainampDBS_20130918_02.ds',...
                '\LN_C11\180913\Raw\LNC011ON_brainampDBS_20130918_03.ds',...
                '\LN_C11\180913\Raw\LNC011ON_brainampDBS_20130918_04.ds',...
                '\LN_C11\180913\Raw\LNC011ON_brainampDBS_20130918_05.ds',...
                };
            sequence = {'R', 'STIM_R_5_130', 'STIM_R_20_0', 'STIM_L_5_130', 'STIM_L_20_0'};
            root = '\LN_C11\180913';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C12'
        if on
        else
            files = {...
                '\LN_C12\270913\Raw\LNC12171050_brainampDBS_20130927_01.ds',...
                '\LN_C12\270913\Raw\LNC12171050_brainampDBS_20130927_02.ds',...
                '\LN_C12\270913\Raw\LNC12171050_brainampDBS_20130927_03.ds',...
                '\LN_C12\270913\Raw\LNC12171050_brainampDBS_20130927_04.ds',...
                '\LN_C12\270913\Raw\LNC12171050_brainampDBS_20130927_05.ds',...
                };
            sequence = {'R', 'STIM_R_20_130', 'STIM_R_5_0', 'STIM_L_20_130', 'STIM_L_5_0'};
            root = '\LN_C12\270913';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C13'
        if on
            files = {...
                '\LN_C13\300913\Raw\LNC13010348_brainampDBS_20130930_01.ds',...
                '\LN_C13\300913\Raw\LNC13010348_brainampDBS_20130930_02.ds',...
                '\LN_C13\300913\Raw\LNC13010348_brainampDBS_20130930_03.ds',...
                '\LN_C13\300913\Raw\LNC13010348_brainampDBS_20130930_04.ds',...
                };
            sequence = {'R', 'RT', 'RT', 'R'};
            root = '\LN_C13\300913';
            details.lfpthresh = 45;
            details.brainamp = 1;
        end
        ind   =  spm_match_str(montage.labelnew, {'STN_L12', 'STN_L23'});
        
        montage.labelnew(ind) = [];
        montage.tra(ind, :)  = [];
        
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_L01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_L12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_L23';
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'EMG_R_ECR';
        
        
        chan = {'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C14'
        if on
        else
            files = {...
                '\LN_C14\171013\Raw\LNC14240263_brainampDBS_20131017_01.ds',...
                '\LN_C14\171013\Raw\LNC14240263_brainampDBS_20131017_02.ds',...
                '\LN_C14\171013\Raw\LNC14240263_brainampDBS_20131017_03.ds',...
                '\LN_C14\171013\Raw\LNC14240263_brainampDBS_20131017_04.ds',...
                '\LN_C14\171013\Raw\LNC14240263_brainampDBS_20131017_05.ds',...
                };
            sequence = {'RD', 'R', 'RT', 'RT', 'R'};
            root = '\LN_C14\171013\';
            details.lfpthresh = 45;
            details.brainamp = 1;
        end
        
        ind   =  spm_match_str(montage.labelnew, {'STN_L01', 'STN_L12', 'STN_L23', 'Cz'});
        
        montage.labelnew(ind) = [];
        montage.tra(ind, :)  = [];
        
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_L01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_L12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_L23';
        
        chan = {'LFP_L01', 'LFP_L12', 'LFP_L23'};
        megbad = {'MLO42'};
    case 'LN_C15'
        if on
            files = {...
                '\LN_C15\191013\LNC15280743_brainampDBS_20131019_04.ds',...
                '\LN_C15\191013\LNC15280743_brainampDBS_20131019_05.ds',...
                };
            sequence = {'R1', 'R2',  'OTHER'};
            root = '\LN_C15\191013on';
        else
            files = {...
                '\LN_C15\191013\LNC15280743_brainampDBS_20131019_01.ds',...
                '\LN_C15\191013\LNC15280743_brainampDBS_20131019_02.ds',...
                '\LN_C15\191013\LNC15280743_brainampDBS_20131019_03.ds',...
                };
            sequence = {'R1', 'R2', 'SLEEP'};
            root = '\LN_C15\191013off';
            details.brainamp = 1;
            details.stim = 0;
        end
        
        details.lfpthresh = 65;
        details.brainamp = 1;
        details.stim = 0;
        details.alignhead = 0; % there was a problem with one of the head coils in this recording
        
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'PPN_R01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'PPN_R12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'PPN_R23';
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'PPN_L01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'PPN_L12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'PPN_L23';
        
        montage.labelnew{strmatch('EMG_L', montage.labelnew)} = 'EMG_CHIN';
        
        montage.labelnew{strmatch('Cz', montage.labelnew)} = 'ECG';
        
        chan = {'PPN_R01', 'PPN_R12', 'PPN_R23', 'PPN_L01', 'PPN_L12', 'PPN_L23'};
        megbad = {'MLO42'};
    case 'LN_C16'
        if on
        else
            files = {...
                '\LN_C16\151113\Raw\LNC16180253_brainampDBS_20131115_01.ds',...
                '\LN_C16\151113\Raw\LNC16180253_brainampDBS_20131115_02.ds',...
                '\LN_C16\151113\Raw\LNC16180253_brainampDBS_20131115_03.ds',...
                '\LN_C16\151113\Raw\LNC16180253_brainampDBS_20131115_04.ds',...
                '\LN_C16\151113\Raw\LNC16180253_brainampDBS_20131115_05.ds',...
                };
            sequence = {'R', 'STIM_R_130_5', 'STIM_R_20_0', 'STIM_L_130_5', 'STIM_L_20_0'};
            root = '\LN_C16\151113\';
            montage = [];
            details.lfpthresh = 50;
            details.brainamp = 1;
            details.stim = 1;
        end
        megbad = {'MLO42'};
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C17'
        if on
        else
            files = {...
                '\LN_C17\211113\Raw\LNC17280444_brainampDBS_20131121_01.ds',...
                '\LN_C17\211113\Raw\LNC17280444_brainampDBS_20131121_02.ds',...
                '\LN_C17\211113\Raw\LNC17280444_brainampDBS_20131121_03.ds',...
                '\LN_C17\211113\Raw\LNC17280444_brainampDBS_20131121_04.ds',...
                '\LN_C17\211113\Raw\LNC17280444_brainampDBS_20131121_05.ds',...
                };
            sequence = {'R', 'STIM_R_20_5', 'STIM_R_0_130', 'STIM_L_20_5', 'STIM_L_0_130'};
            root = '\LN_C17\211113\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        megbad = {'MLO42'};
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C18'
        if on
        else
            files = {...
                '\LN_C18\131213\Raw\LNC18160761_brainampDBS_20131213_01.ds',...
                '\LN_C18\131213\Raw\LNC18160761_brainampDBS_20131213_02.ds',...
                };
            sequence = {'R1', 'R2'};
            root = '\LN_C18\131213\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        megbad = {'MLO42'};
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C19'
        if on
        else
            files = {...
                '\LN_C19\060214\Raw\LNC19260268_BrainampDBS_20140206_01.ds',...
                '\LN_C19\060214\Raw\LNC19260268_BrainampDBS_20140206_02.ds',...
                '\LN_C19\060214\Raw\LNC19260268_BrainampDBS_20140206_03.ds',...
                '\LN_C19\060214\Raw\LNC19260268_BrainampDBS_20140206_04.ds',...
                '\LN_C19\060214\Raw\LNC19260268_BrainampDBS_20140206_05.ds',...
                '\LN_C19\060214\Raw\LNC19260268_BrainampDBS_20140206_06.ds',...
                };
            sequence = {'R1', 'R2', 'SR1', 'SL1', 'SL2', 'SR2'};
            root = '\LN_C19\060214';
            details.lfpthresh = 45;
            details.brainamp = 1;
        end
        
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'LFP_L01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'LFP_L12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'LFP_L23';
        
        
        ind   =  spm_match_str(montage.labelnew, {'Cz'});
        
        montage.labelnew(ind) = [];
        montage.tra(ind, :)  = [];
        
        chan = {'LFP_R01', 'LFP_LR2', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C20'
        if on
        else
            files = {...
                '\LN_C20\070214\Raw\LNC20040872_BrainampDBS_20140207_01.ds',...
                '\LN_C20\070214\Raw\LNC20040872_BrainampDBS_20140207_02.ds',...
                '\LN_C20\070214\Raw\LNC20040872_BrainampDBS_20140207_03.ds',...
                '\LN_C20\070214\Raw\LNC20040872_BrainampDBS_20140207_04.ds',...
                '\LN_C20\070214\Raw\LNC20040872_BrainampDBS_20140207_05.ds',...
                };
            sequence = {'R', 'STIM_R_5_130', 'STIM_R_20_0', 'STIM_L_5_130', 'STIM_L_20_0'};
            root = '\LN_C20\070214\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C21'
        if on
        else
            files = {...
                '\LN_C21\170314\Raw\LNC21170356_BrainampDBS_20140317_01.ds',...
                '\LN_C21\170314\Raw\LNC21170356_BrainampDBS_20140317_02.ds',...
                '\LN_C21\170314\Raw\LNC21170356_BrainampDBS_20140317_03.ds',...
                '\LN_C21\170314\Raw\LNC21170356_BrainampDBS_20140317_04.ds',...
                '\LN_C21\170314\Raw\LNC21170356_BrainampDBS_20140317_05.ds',...
                };
            sequence = {'R', 'STIM_R_130_5', 'STIM_R_20_0', 'STIM_L_130_5', 'STIM_L_20_0'};
            root = '\LN_C21\170314\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C22'
        if on
        else
            files = {...
                '\LN_C22\250414\Raw\LNC22160346_BrainampDBS_20140425_01.ds',...
                '\LN_C22\250414\Raw\LNC22160346_BrainampDBS_20140425_02.ds',...
                '\LN_C22\250414\Raw\LNC22160346_BrainampDBS_20140425_03.ds',...
                '\LN_C22\250414\Raw\LNC22160346_BrainampDBS_20140425_04.ds',...
                '\LN_C22\250414\Raw\LNC22160346_BrainampDBS_20140425_05.ds',...
                };
            sequence = {'R', 'STIM_R_130_20', 'STIM_R_5_0', 'STIM_L_130_20', 'STIM_L_5_0'};
            root = '\LN_C22\250414\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C23'
        if on
        else
            files = {...
                '\LN_C23\130514\Raw\LNC23170353_BrainampDBS_20140513_01.ds',...
                '\LN_C23\130514\Raw\LNC23170353_BrainampDBS_20140513_02.ds',...
                '\LN_C23\130514\Raw\LNC23170353_BrainampDBS_20140513_03.ds',...
                '\LN_C23\130514\Raw\LNC23170353_BrainampDBS_20140513_04.ds',...
                '\LN_C23\130514\Raw\LNC23170353_BrainampDBS_20140513_05.ds',...
                };
            sequence = {'R', 'STIM_R_130_20', 'STIM_R_5_0', 'STIM_L_130_20', 'STIM_L_5_0'};
            root =  '\LN_C23\130514\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C24'
        if on
        else
            files = {...
                '\LN_C24\020614\Raw\LNC24111253_BrainampDBS_20140602_01.ds',...
                '\LN_C24\020614\Raw\LNC24111253_BrainampDBS_20140602_02.ds',...
                '\LN_C24\020614\Raw\LNC24111253_BrainampDBS_20140602_03.ds',...
                '\LN_C24\020614\Raw\LNC24111253_BrainampDBS_20140602_04.ds',...
                };
            sequence = {'R', 'STIM_R_0_130', 'STIM_R_5', 'STIM_L_0_130'};
            root =  '\LN_C24\020614\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C25'
        if on
        else
            files = {...
                '\LN_C25\050614\Raw\LNC25120250_BrainampDBS_20140605_01.ds',...
                '\LN_C25\050614\Raw\LNC25120250_BrainampDBS_20140605_02.ds',...
                '\LN_C25\050614\Raw\LNC25120250_BrainampDBS_20140605_03.ds',...
                '\LN_C25\050614\Raw\LNC25120250_BrainampDBS_20140605_04.ds',...
                '\LN_C25\050614\Raw\LNC25120250_BrainampDBS_20140605_05.ds',...
                '\LN_C25\050614\Raw\LNC25120250_BrainampDBS_20140605_06.ds',...
                '\LN_C25\050614\Raw\LNC25120250_BrainampDBS_20140605_07.ds',...
                '\LN_C25\050614\Raw\LNC25120250_BrainampDBS_20140605_08.ds',...
                '\LN_C25\050614\Raw\LNC25120250_BrainampDBS_20140605_09.ds'
                };
            sequence = {'R', 'STIM_R_0_20', 'BSTIM_R_20', 'STIM_L_0_20', 'BSTIM_L_20',...
                'POSNER', 'POSNER', 'POSNER', 'POSNER'};
            root = '\LN_C25\050614\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        details.diagnosis = 'DLB';
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C26'
        if on
        else
            files = {...
                '\LN_C26\060614\Raw\LNC26011041_BrainampDBS_20140606_01.ds',...
                '\LN_C26\060614\Raw\LNC26011041_BrainampDBS_20140606_02.ds',...
                '\LN_C26\060614\Raw\LNC26011041_BrainampDBS_20140606_03.ds',...
                '\LN_C26\060614\Raw\LNC26011041_BrainampDBS_20140606_04.ds',...
                '\LN_C26\060614\Raw\LNC26011041_BrainampDBS_20140606_05.ds',...
                '\LN_C26\060614\Raw\LNC26011041_BrainampDBS_20140606_06.ds',...
                '\LN_C26\060614\Raw\LNC26011041_BrainampDBS_20140606_07.ds'
                };
            sequence = {'R', 'STIM_R_0_20', 'BSTIM_R_20', 'STIM_L_0_20', 'BSTIM_L_20', 'POSNER', 'POSNER'};
            root = '\LN_C26\060614\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        details.diagnosis = 'DLB';
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C27'
        if on
            files = {...
                '\LN_C27\190614\Raw\LNC27160649_BrainampDBS_20140619_01.ds',...
                '\LN_C27\190614\Raw\LNC27160649_BrainampDBS_20140619_02.ds',...
                '\LN_C27\190614\Raw\LNC27160649_BrainampDBS_20140619_03.ds',...
                '\LN_C27\190614\Raw\LNC27160649_BrainampDBS_20140619_04.ds',...
                '\LN_C27\190614\Raw\LNC27160649_BrainampDBS_20140619_05.ds',...
                '\LN_C27\190614\Raw\LNC27160649_BrainampDBS_20140619_06.ds',...
                '\LN_C27\190614\Raw\LNC27160649_BrainampDBS_20140619_07.ds'
                };
            sequence = {'R', 'RT', 'R', 'RT', 'SLEEP_JUNK', 'R', 'R'};
            root = '\LN_C27\190614\';
            details.lfpthresh = 15;
            details.brainamp = 1;
        else
        end
        
        montage.labelnew{strmatch('EMG_L', montage.labelnew)} = 'EMG_FA_R';
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'LFP_L01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'LFP_L12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'LFP_L23';
        
        
        ind   =  spm_match_str(montage.labelnew, {'STN_R01', 'STN_R12', 'STN_R23'});
        
        montage.labelnew(ind) = [];
        montage.tra(ind, :)  = [];
        
        chan = {'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C28'
        if on
        else
            files = {...
                '\LN_C28\110714\Raw\LNC28250657_BrainampDBS_20140711_01.ds',...
                '\LN_C28\110714\Raw\LNC28250657_BrainampDBS_20140711_02.ds'
                };
            sequence = {'R', 'STIM_R_5_130'};
            root = '\LN_C28\110714\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'PHANTOM'
        if on
            files = {...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_01.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_02.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_03.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_04.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_05.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_06.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_07.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_08.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_09.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_10.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_11.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_12.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_13.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_14.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_15.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_16.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_17.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_18.ds',...
                '\Phantom\090715\Raw\phantom090715_BrainampDBS_20150709_19.ds'
                };
            sequence = {'STIM_W1_FM0_M0','STIM_W0_FM0_M0','STIM_W0_FM130_M0','STIM_W0_FM130_M1','STIM_W0_FM0_M1','STIM_W1_FM0_M1'...
                'STIM_W1_FM130_M1','STIM_W1_FM130_M0','STIM_W1_FM20_M0','STIM_W1_FM5_M0','STIM_W1_FM5_M1','STIM_W1_FM20_M1'...
                'STIM_W1_FB130_M1','STIM_W1_FB20_M1','STIM_W1_FB5_M1','STIM_W0_FM20_M1','STIM_W0_FM5_M1','STIM_W0_FM5_M0'...
                'STIM_W0_FM20_M0'};
            % W - wires, FM - frequency monopolar, FB - frequency bipolar,
            % M - movement
            root = '\Phantom\090715\';
            %montage = [];
            montage.lblorig = {'LFP_L0R0', 'LFP_R01',  'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
            montage.lblnew  = {'LFP_CLEAN', 'Unused1', 'Unused2', 'Unused3', 'Unused4','Unused5', 'Unused6'};
            details.lfpthresh = Inf;
            details.brainamp = 1;
            details.stim = 1;
            details.cont_head_loc = 0;
            
            megbad = {'MLO42'};
            
            chan = {'LFP_CLEAN'};
            
        else
            files = {...
                '\Phantom\090714\Raw\090714_CurrentPhantom_20140709_06.ds',...
                '\Phantom\090714\Raw\090714_CurrentPhantom_20140709_07.ds',...
                '\Phantom\090714\Raw\090714_CurrentPhantom_20140709_08.ds',...
                '\Phantom\090714\Raw\090714_CurrentPhantom_20140709_09.ds',...
                '\Phantom\090714\Raw\090714_CurrentPhantom_20140709_10.ds',...
                '\Phantom\090714\Raw\090714_CurrentPhantom_20140709_11.ds',...
                '\Phantom\090714\Raw\090714_CurrentPhantom_20140709_12.ds'
                };
            sequence = {'R', 'STIM_P_130', 'STIM_P_20', 'STIM_P_5', 'BSTIM_130', 'BSTIM_20', 'BSTIM_5'};
            root = '\Phantom\090714\';
            montage = [];
            montage.lblorig = {'LFP_L0R0', 'LFP_R01',  'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
            montage.lblnew  = {'LFP_CLEAN', 'LFP_STIM', 'Unused1', 'Unused2', 'Unused3', 'Unused4','Unused5'};
            details.lfpthresh = Inf;
            details.brainamp = 1;
            details.stim = 1;
            
            details.cont_head_loc = 0;
            
            chan = {'LFP_CLEAN'};
        end
        
        
    case 'LN_C29'
        if on
            files = {...
                '\LN_C29\030914\Raw\LNC29100339_BrainampDBS_20140903_01.ds',...
                '\LN_C29\030914\Raw\LNC29100339_BrainampDBS_20140903_02.ds',...
                '\LN_C29\030914\Raw\LNC29100339_BrainampDBS_20140903_03.ds',...
                '\LN_C29\030914\Raw\LNC29100339_BrainampDBS_20140903_04.ds',...
                '\LN_C29\030914\Raw\LNC29100339_BrainampDBS_20140903_05.ds',...
                '\LN_C29\030914\Raw\LNC29100339_BrainampDBS_20140903_06.ds',...
                '\LN_C29\030914\Raw\LNC29100339_BrainampDBS_20140903_07.ds'
                };
            sequence = {'R', 'STIM_R_0_20', 'STIM_R_130', 'BSTIM_R01_20_130', 'STIM_L_0_20_130', 'BSTIM_L01_20_130', 'POSNER'};
            root = '\LN_C29\030914\';
            montage = [];
            details.lfpthresh = 45;
            details.brainamp = 1;
            details.stim = 1;
        end
        details.diagnosis = 'PDD';
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C30'
        if on
            files = {...
                '\LN_C30\151014\Raw\LNC-30-bh050250_BrainampDBS_20141015_01.ds',...
                '\LN_C30\151014\Raw\LNC-30-bh050250_BrainampDBS_20141015_02.ds',...
                '\LN_C30\151014\Raw\LNC-30-bh050250_BrainampDBS_20141015_03.ds'
                };
            sequence = {'R', 'RT', 'R'};
            root = '\LN_C30\151014\';
            details.lfpthresh = 25;
            details.brainamp = 1;
            details.accelerometer = 1;
        else
        end
        
        
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'LFP_L01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'LFP_L12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'LFP_L23';
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C31'
        if on
            files = {...
                '\LN_C31\081214\Raw\LNC31_BrainampDBS_20141208_01.ds', ...
                '\LN_C31\081214\Raw\LNC31_BrainampDBS_20141208_02.ds', ...
                '\LN_C31\081214\Raw\LNC31_BrainampDBS_20141208_03.ds', ...
                '\LN_C31\081214\Raw\LNC31_BrainampDBS_20141208_04.ds'
                };
            root = '\LN_C31\081214\';
            sequence = {'R1', 'MICE', 'MICE', '_MICE800'};
            details.lfpthresh = 10;
            details.brainamp = 1;
            details.timewin = [300 500];
            details.freqwin = [26 32];
            details.w = [0.1652, -0.7427, 0.4326, -0.6222, -0.1773, -0.1838];
        end
    case 'LN_C32'
        if on
            files = {...
                '\LN_C32\150115\Raw\LNC32041041_BrainampDBS_20150115_01.ds',...
                '\LN_C32\150115\Raw\LNC32041041_BrainampDBS_20150115_02.ds',...
                '\LN_C32\150115\Raw\LNC32041041_BrainampDBS_20150115_03.ds'
                };
            sequence = {'R', 'STIM_L_0_20', 'STIM_R_0_20'};
            root = '\LN_C32\150115\';
            montage = [];
            details.lfpthresh = 15;
            details.brainamp = 1;
            details.stim = 1;
        end
        details.diagnosis = 'PDD';
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C33'
        if on
            files = {...
                '\LN_C33\230115\Raw\LNC33161049_BrainampDBS_20150123_01.ds',...
                '\LN_C33\230115\Raw\LNC33161049_BrainampDBS_20150123_02.ds',...
                '\LN_C33\230115\Raw\LNC33161049_BrainampDBS_20150123_03.ds',...
                '\LN_C33\230115\Raw\LNC33161049_BrainampDBS_20150123_04.ds',...
                '\LN_C33\230115\Raw\LNC33161049_BrainampDBS_20150123_05.ds',...
                '\LN_C33\230115\Raw\LNC33161049_BrainampDBS_20150123_06.ds',...
                '\LN_C33\230115\Raw\LNC33161049_BrainampDBS_20150123_07.ds',...
                };
            sequence = {'R', 'STIM_R_0_20', 'BSTIM_R_20', 'STIM_L_0_20', 'BSTIM_L_20', 'POSNER', 'POSNER'};
            root = '\LN_C33\230115\';
            montage = [];
            details.lfpthresh = 7;
            details.brainamp = 1;
            details.stim = 1;
        end
        details.diagnosis = 'PDD';
        megbad = {'MLO42'};
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C35'
        if on
            files = {...
                '\LN_C35\230215\Raw\LNC35_BrainampDBS_20150223_01.ds', ...
                '\LN_C35\230215\Raw\LNC35_BrainampDBS_20150223_02.ds', ...
                '\LN_C35\230215\Raw\LNC35_BrainampDBS_20150223_03.ds', ...
                '\LN_C35\230215\Raw\LNC35_BrainampDBS_20150223_04.ds', ...
                '\LN_C35\230215\Raw\LNC35_BrainampDBS_20150223_05.ds', ...
                };
            root = '\LN_C35\230215\';
            sequence = {'R1', 'MICE1', 'MICE2', 'MICE3', 'MICE4'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.timewin = [450 650];
            details.freqwin = [10 14];
            megbad = {'MLO42'};
        end
    case 'LN_C36'
        if on
            files = {...
                '\LN_C36\020305\Raw\LNC36180747_BrainampDBS_20150302_01.ds', ...
                '\LN_C36\020305\Raw\LNC36180747_BrainampDBS_20150302_02.ds', ...
                };
            root = '\LN_C36\020305\';
            sequence = {'R1', 'MICE1'};
            details.lfpthresh = 25;
            details.brainamp = 1;
            
            megbad = {'MLO42'};
        end
        
        ind   =  spm_match_str(montage.labelnew, {'EMG_R', 'EMG_L', 'Cz'});
        
        montage.labelnew(ind) = [];
        montage.tra(ind, :)  = [];
    case 'LN_C37'
        if on
            files = {...
                '\LN_C37\150315\Raw\LNC37310755_BrainampDBS_20150315_01.ds', ...
                '\LN_C37\150315\Raw\LNC37310755_BrainampDBS_20150315_02.ds', ...
                '\LN_C37\150315\Raw\LNC37310755_BrainampDBS_20150315_03.ds', ...
                '\LN_C37\150315\Raw\LNC37310755_BrainampDBS_20150315_04.ds', ...
                '\LN_C37\150315\Raw\LNC37310755_BrainampDBS_20150315_05.ds', ...
                '\LN_C37\150315\Raw\LNC37310755_BrainampDBS_20150315_06.ds', ...
                '\LN_C37\150315\Raw\LNC37310755_BrainampDBS_20150315_07.ds'
                };
            root = '\LN_C37\150315\';
            sequence = {'R1', 'R2', 'MICE1', 'MICE2', 'JUNK', 'MICE3', 'MICE4'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.timewin = [200 350];
            details.freqwin = [18 24];
            
            megbad = {'MLO42'};
        end
    case 'LN_C38'
        if on
            files = {...
                '\LN_C38\270315\Raw\LNC38_BrainampDBS_20150327_01.ds', ...
                '\LN_C38\270315\Raw\LNC38_BrainampDBS_20150327_03.ds', ...
                '\LN_C38\270315\Raw\LNC38_BrainampDBS_20150327_04.ds', ...
                '\LN_C38\270315\Raw\LNC38_BrainampDBS_20150327_05.ds', ...
                '\LN_C38\270315\Raw\LNC38_BrainampDBS_20150327_06.ds', ...
                };
            root =  '\LN_C38\270315\';
            sequence = {'R1', 'MICE1', 'MICE2', 'MICE3', 'MICE4'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.timewin = [300 550];
            details.freqwin = [18 26];
            
            megbad = {'MLO42'};
        end
    case 'LN_C39'
        if on
            files = {...
                '\LN_C39\020415\Raw\310315_BrainampDBS_20150402_01.ds', ...
                '\LN_C39\020415\Raw\LNC39131261_BrainampDBS_20150402_02.ds', ...
                '\LN_C39\020415\Raw\LNC39131261_BrainampDBS_20150402_01.ds' % 02 then 01 is correct
                };
            root =  '\LN_C39\020415\';
            sequence = {'R1', 'MICE1', 'MICE2'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.timewin = [300 550];
            details.freqwin = [20 30];
            megbad = {'MLO42'};
        end
    case 'LN_C40'
        if on
            files = {...
                '\LN_C40\200415\Raw\LNC40-261155_BrainampDBS_20150420_01.ds', ...
                '\LN_C40\200415\Raw\LNC40-261155_BrainampDBS_20150420_02.ds'
                };
            root =  '\LN_C40\200415\';
            sequence = {'R1', 'MICE1'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            
            megbad = {'MLO42'};
        end
    case 'LN_C41'
        if on
            files = {...
                '\LN_C41\040515\Raw\ag170592_BrainampDBS_20150504_01.ds',...
                '\LN_C41\040515\Raw\LNC41160137_BrainampDBS_20150504_01.ds',...
                '\LN_C41\040515\Raw\LNC41160137_BrainampDBS_20150504_02.ds',...
                '\LN_C41\040515\Raw\LNC41160137_BrainampDBS_20150504_03.ds',...
                '\LN_C41\040515\Raw\LNC41160137_BrainampDBS_20150504_04.ds',...
                };
            sequence = {'R', 'RT', 'R', 'RT', 'RT'};
            root = '\LN_C41\040515\';
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.accelerometer = 1;
        end
        
        megbad = {'MLO42'};
        
        ind   =  spm_match_str(montage.labelnew, {'STN_R01', 'STN_R12', 'STN_R23', 'Cz'});
        
        montage.labelnew(ind) = [];
        montage.tra(ind, :)  = [];
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'LFP_L01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'LFP_L12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'LFP_L23';
        
        chan = {'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C42'
        if on
            files = {...
                '\LN_C42\210515\Raw\LNC42-181068_BrainampDBS_20150521_01.ds',...
                '\LN_C42\210515\Raw\LNC42-181068_BrainampDBS_20150521_02.ds',...
                '\LN_C42\210515\Raw\LNC42-181068_BrainampDBS_20150521_03.ds',...
                '\LN_C42\210515\Raw\LNC42-181068_BrainampDBS_20150521_04.ds',...
                '\LN_C42\210515\Raw\LNC42-181068_BrainampDBS_20150521_05.ds',...
                '\LN_C42\210515\Raw\LNC42-181068_BrainampDBS_20150521_06.ds',...
                '\LN_C42\210515\Raw\LNC42-181068_BrainampDBS_20150521_07.ds',...
                };
            sequence = {'R', 'STIM_R_0', 'STIM_R_20', 'STIM_R_0_20', 'BSTIM_R_20', 'STIM_L_0_20', 'BSTIM_L_20'};
            root = '\LN_C42\210515\';
            montage = [];
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.stim = 1;
        end
        details.diagnosis = 'PDD';
        megbad = {'MLO42'};
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C43'
        if on
            files = {...
                '\LN_C43\280615\Raw\LNC43251248_BrainampDBS_20150628_01.ds', ...
                '\LN_C43\280615\Raw\LNC43251248_BrainampDBS_20150628_02.ds', ...
                '\LN_C43\280615\Raw\LNC43251248_BrainampDBS_20150628_03.ds', ...
                '\LN_C43\280615\Raw\LNC43251248_BrainampDBS_20150628_04.ds'
                };
            root =  '\LN_C43\280615\';
            sequence = {'R1', 'MICE1', 'MICE2', 'MICE3'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            
            megbad = {'MLO42'};
        end
    case 'LN_C44'
        if on
            files = {...
                '\LN_C44\300715\Raw\LNC-44-rb240544_BrainampDBS_20150730_01.ds', ...
                '\LN_C44\300715\Raw\LNC-44-rb240544_BrainampDBS_20150730_02.ds', ...
                '\LN_C44\300715\Raw\LNC-44-rb240544_BrainampDBS_20150730_03.ds'
                };
            root =  '\LN_C44\300715\';
            sequence = {'R1', 'STIM_R_0_20', 'BSTIM_R_20'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.stim = 1;
            montage = [];
            megbad = {'MLO42'};
        end
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        details.diagnosis = 'PDD';
    case 'LN_C45'
        if on
            files = {...
                '\LN_C45\070815\Raw\LNC45_BrainampDBS_20150807_01.ds', ...
                '\LN_C45\070815\Raw\LNC45_BrainampDBS_20150807_02.ds'
                };
            root =  '\LN_C45\070815\';
            sequence = {'R1', 'R2'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            
            megbad = {'MLO42'};
        end
    case 'LN_C46'
        if on
            files = {...
                '\LN_C46\260915\Raw\LNC46090965_BrainampDBS_20150926_01.ds', ...
                '\LN_C46\260915\Raw\LNC46090965_BrainampDBS_20150926_02.ds', ...
                '\LN_C46\260915\Raw\LNC46090965_BrainampDBS_20150926_03.ds', ...
                };
            root =  '\LN_C46\260915\';
            sequence = {'R1', 'MICE1', 'MICE2',};
            details.lfpthresh = 30;
            details.brainamp = 1;
            
            megbad = {'MLO42'};
        end
    case 'LN_C47'
        if on
            files = {...
                '\LN_C47\081015\Raw\LNC47DW080140_BrainampDBS_20151008_01.ds',...
                '\LN_C47\081015\Raw\LNC47DW080140_BrainampDBS_20151008_02.ds',...
                '\LN_C47\081015\Raw\LNC47DW080140_BrainampDBS_20151008_03.ds',...
                '\LN_C47\081015\Raw\LNC47DW080140_BrainampDBS_20151008_04.ds',...
                '\LN_C47\081015\Raw\LNC47DW080140_BrainampDBS_20151008_05.ds',...
                };
            sequence = {'R', 'STIM_R_0_20', 'BSTIM_R_20', 'STIM_L_0_20', 'BSTIM_L_20'};
            root = '\LN_C47\081015\';
            montage = [];
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.stim = 1;
        end
        details.diagnosis = 'DLB';
        megbad = {'MLO42'};
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C48'
        if on
            files = {...
                '\LN_C48\271115\Raw\mg4484_BrainampDBS_20151127_01.ds', ...
                '\LN_C48\271115\Raw\mg4484_BrainampDBS_20151127_02.ds', ...
                '\LN_C48\271115\Raw\mg4484_BrainampDBS_20151127_03.ds', ...
                '\LN_C48\271115\Raw\mg4484_BrainampDBS_20151127_04.ds', ...
                '\LN_C48\271115\Raw\mg4484_BrainampDBS_20151127_05.ds', ...
                '\LN_C48\271115\Raw\mg4484_BrainampDBS_20151127_06.ds'
                };
            root =  '\LN_C48\271115\';
            sequence = {'R1', 'MICE1', 'MICE2', 'MICE3', 'MICE4', 'R2'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.timewin = [400 600];
            details.freqwin = [18 28];
            
            megbad = {'MLO42'};
        end
    case 'LN_C49'
        if on
            files = {...
                '\LN_C49\140116\Raw\mg4501_BrainampDBS_20160114_01.ds',...
                '\LN_C49\140116\Raw\mg4501_BrainampDBS_20160114_02.ds',...
                '\LN_C49\140116\Raw\mg4501_BrainampDBS_20160114_03.ds',...
                '\LN_C49\140116\Raw\mg4501_BrainampDBS_20160114_04.ds',...
                '\LN_C49\140116\Raw\mg4501_BrainampDBS_20160114_05.ds'
                };
            sequence = {'R', 'RT', 'R', 'RT', 'RT'};
            root = '\LN_C49\140116\';
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.accelerometer = 1;
        end
        
        megbad = {'MLO42', 'MRC12', 'MRP53'};
        
        ind   =  spm_match_str(montage.labelnew, {'STN_R01', 'STN_R12', 'STN_R23', 'Cz'});
        
        montage.labelnew(ind) = [];
        montage.tra(ind, :)  = [];
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'LFP_L01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'LFP_L12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'LFP_L23';
        
        montage.labelnew{strmatch('EMG_L', montage.labelnew)} = 'EMG_FA_R';
        
        chan = {'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C54'
        if on
            files = {...
                '\LN_C54\100316\Raw\mg4576_BrainampDBS_20160310_01.ds',...
                '\LN_C54\100316\Raw\mg4576_BrainampDBS_20160310_02.ds',...
                '\LN_C54\100316\Raw\mg4576_BrainampDBS_20160310_03.ds',...
                '\LN_C54\100316\Raw\mg4576_BrainampDBS_20160310_04.ds',...
                '\LN_C54\100316\Raw\mg4576_BrainampDBS_20160310_05.ds',...
                '\LN_C54\100316\Raw\mg4576_BrainampDBS_20160310_06.ds',...
                '\LN_C54\100316\Raw\mg4576_BrainampDBS_20160310_07.ds'
                };
            sequence = {'R', 'STIM_R_0_20', 'BSTIM_R_20', 'STIM_L_0_20', 'BSTIM_L_20', 'POSNER', 'POSNER'};
            root = '\LN_C54\100316\';
            montage = [];
            details.lfpthresh = 30;
            details.brainamp = 1;
            details.stim = 1;
            
            ind   =  spm_match_str(details.chanset, {'UPPT001'    'UPPT002'});
            details.chanset(ind) = [];
        end
        
        details.diagnosis = 'DLB';
        
        megbad = {'MLO42', 'MRC12', 'MRP53'};
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        
    case 'LN_C55'
        if on
            files = {...
                '\LN_C55\180316\Raw\mg4581_BrainampDBS_20160318_01.ds',...
                '\LN_C55\180316\Raw\mg4581_BrainampDBS_20160318_02.ds',...
                '\LN_C55\180316\Raw\mg4581_BrainampDBS_20160318_03.ds'
                };
            sequence = {'R1', 'R2', 'R3'};
            root = '\LN_C55\180316\';
            details.lfpthresh = 30;
            details.brainamp = 1;
        end
        
        megbad = {'MLO42', 'MRC12', 'MRP53'};
        
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'LFP_L01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'LFP_L12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'LFP_L23';
        
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
    case 'LN_C56'
        if on
            files = {...
                '\LN_C56\230516\Raw\mg4654_BrainampDBS_20160523_01.ds', ...
                '\LN_C56\230516\Raw\mg4654_BrainampDBS_20160523_02.ds', ...
                '\LN_C56\230516\Raw\mg4654_BrainampDBS_20160523_03.ds', ...
                '\LN_C56\230516\Raw\mg4654_BrainampDBS_20160523_04.ds', ...
                '\LN_C56\230516\Raw\mg4654_BrainampDBS_20160523_05.ds'
                };
            root =  '\LN_C56\230516\';
            sequence = {'R1', 'MICE1', 'MICE2', 'MICE3', 'R2'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            
            details.timewin = [300 550];
            details.freqwin = [20 30];
            
            
            megbad = {'MLO42', 'MRC12', 'MRP53'};
        end
    case 'LN_C57'
        if on
            files = {...
                '\LN_C57\280716\Raw\mg4688_BrainampDBS_20160728_01.ds', ...
                '\LN_C57\280716\Raw\mg4688_BrainampDBS_20160728_03.ds', ...
                '\LN_C57\280716\Raw\mg4688_BrainampDBS_20160728_04.ds', ...
                '\LN_C57\280716\Raw\mg4688_BrainampDBS_20160728_05.ds'
                };
            root =  '\LN_C57\280716\';
            sequence = {'NF', 'R1', 'MICE1', 'MICE2'};
            details.lfpthresh = 30;
            details.brainamp = 1;
            
            ind   =  spm_match_str(montage.labelnew, {'STN_R01'});
            
            montage.labelnew(ind) = [];
            montage.tra(ind, :)  = [];
            details.timewin = [300 550];
            details.freqwin = [20 30];
            
            chan = {'STN_R12', 'STN_R23', 'STN_L01', 'STN_L12', 'STN_L23'};
            megbad = {'MLO42', 'MRC12', 'MRP53'};
        end
    case 'LN_C58'
        if on
            files = {...
                '\LN_C58\131016\Raw\mg4723_BrainampDBS_20161013_01.ds', ...
                '\LN_C58\131016\Raw\mg4723_BrainampDBS_20161013_03.ds', ...
                '\LN_C58\131016\Raw\mg4723_BrainampDBS_20161013_04.ds', ...
                '\LN_C58\131016\Raw\mg4723_BrainampDBS_20161013_05.ds', ...
                '\LN_C58\131016\Raw\mg4723_BrainampDBS_20161013_06.ds'
                };
            root =  '\LN_C58\131016\';
            sequence = {'R1', 'MICE1', 'MICE2', 'MICE3', 'MICE4'};
            details.lfpthresh = 30;
            details.brainamp = 1;
                        
            details.timewin = [250 600];
            details.freqwin = [16 28];
            
            chan = {'STN_R01', 'STN_R12', 'STN_R23', 'STN_L01', 'STN_L12', 'STN_L23'};
            megbad = {'MLO42', 'MRC12', 'MRP53'};
        end
    case 'LN_C59'
        if on
            files = {...
                '\LN_C59\111116\Raw\mg4742_BrainampDBS_20161111_01.ds', ...
                '\LN_C59\111116\Raw\mg4742_BrainampDBS_20161111_02.ds', ...
                '\LN_C59\111116\Raw\mg4742_BrainampDBS_20161111_03.ds', ...
                '\LN_C59\111116\Raw\mg4742_BrainampDBS_20161111_04.ds', ...
                '\LN_C59\111116\Raw\mg4742_BrainampDBS_20161111_05.ds'
                };
            root =  '\LN_C59\111116\';
            sequence = {'R1', 'MICE1', 'MICE2', 'MICE3', 'MICE4'};
            details.lfpthresh = 50;
            details.brainamp = 1;
            details.boston = 1;
            
            details.timewin = [250 600];
            details.freqwin = [16 28];
            
            chan = {'STN_R01', 'STN_R12', 'STN_R23', 'STN_L01', 'STN_L12', 'STN_L23'};
            megbad = {'MLO42', 'MRC12', 'MRP53'};
        end
    case 'OXSH1'
        files = {...
            '\OXSH1\Raw\ChaiWeiqiang_raw_003_tsss.fif',...
            '\OXSH1\Raw\CaiWeiqiang_raw_004_tsss.fif'};
        root =  '\OXSH1\';
        sequence = {'R', 'R'};
        details.lfpthresh = 250;
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
        
        details.chanset = getfield(load(fullfile(dbsroot, root, 'SH1_chanlabels.mat')), 'label');
        montage = getfield(load(fullfile(dbsroot, root, 'SH1_montage.mat')), 'montage');
    case 'OXSH2'
        files = {...
            '\OXSH2\Raw\XuHuawei_dystonia_raw_001_right_tsss.fif'};         
        root =  '\OXSH2\';
        sequence = {'R'};
        details.lfpthresh = 60;
        chan = {'LFP_R01', 'LFP_R12', 'LFP_R23'};
        
        details.chanset = getfield(load(fullfile(dbsroot, root, 'SH2_chanlabels.mat')), 'label');
        montage = getfield(load(fullfile(dbsroot, root, 'SH2_montage.mat')), 'montage');        
    case 'LN_NFB2'
        if on
            files = {...
                '\LN_NFB2\070117\Raw\LN_NFB2_ON_rest1.txt', ...
                '\LN_NFB2\070117\Raw\LN_NFB2_ON_NFB1.txt', ...
                '\LN_NFB2\070117\Raw\LN_NFB2_ON_NFB2.txt', ...
                '\LN_NFB2\070117\Raw\LN_NFB2_ON_NFB3.txt'
                };
            root =  '\LN_NFB2\070117_on';
            sequence = {'R1', 'NFB1', 'NFB2', 'NFB3'};
           
        else
            files = {...
                '\LN_NFB2\070117\Raw\LN_NFB2_OFF_rest1.txt', ...
                '\LN_NFB2\070117\Raw\LN_NFB2_OFF_NFB1.txt', ...
                '\LN_NFB2\070117\Raw\LN_NFB2_OFF_NFB2.txt', ...
                '\LN_NFB2\070117\Raw\LN_NFB2_OFF_NFB3.txt'
                };
            root =  '\LN_NFB2\070117_off';
            sequence = {'R1', 'NF1', 'NF2', 'NF3'};
        end
        
        details.lfpthresh = 150;
        details.brainamp = 0;
        details.boston = 0;
        
        details.origchan = {'L0', 'L1', 'L2', 'L3', 'R0', 'R1', 'R2', 'R3', 'FCz', 'Cz', 'M1', 'M2'};
        
        chan = {'STN_R01', 'STN_R12', 'STN_R23', 'STN_L01', 'STN_L12', 'STN_L23'};
        
        montage = [];
        montage.labelorg = details.origchan;
        montage.labelnew = [chan 'FCz-Cz', 'FCz', 'Cz'];
        montage.tra      = [
            0     0     0     0    -1     1     0     0     0     0     0     0
            0     0     0     0     0    -1     1     0     0     0     0     0
            0     0     0     0     0     0    -1     1     0     0     0     0
           -1     1     0     0     0     0     0     0     0     0     0     0           
            0    -1     1     0     0     0     0     0     0     0     0     0
            0     0    -1     1     0     0     0     0     0     0     0     0
            0     0     0     0     0     0     0     0     1    -1     0     0
            0     0     0     0     0     0     0     0     1     0  -0.5  -0.5
            0     0     0     0     0     0     0     0     0     1  -0.5  -0.5
            ];
    case 'LN_VTA2'
        if on
            files = {...
                '\LN_VTA2\040517\Raw\mg04938_BrainampDBS_20170504_01.ds', ...
                '\LN_VTA2\040517\Raw\mg04938_BrainampDBS_20170504_02.ds', ...
                '\LN_VTA2\040517\Raw\mg04938_BrainampDBS_20170504_03.ds', ...
                '\LN_VTA2\040517\Raw\mg04938_BrainampDBS_20170504_04.ds', ...          
                };
            root =  '\LN_VTA2\040517\';
            sequence = {'R1', 'DS1', 'DS2', 'DS3'};
            details.lfpthresh = 50;
            details.brainamp = 1;         
                       
            chan = {'LFP_R01', 'LFP_R12', 'LFP_R23', 'LFP_L01', 'LFP_L12', 'LFP_L23'};
            megbad = {'MLO42', 'MRC12', 'MRP53'};
        end
        
        montage.labelnew{strmatch('STN_R01', montage.labelnew)} = 'LFP_R01';
        montage.labelnew{strmatch('STN_R12', montage.labelnew)} = 'LFP_R12';
        montage.labelnew{strmatch('STN_R23', montage.labelnew)} = 'LFP_R23';
        
        montage.labelnew{strmatch('STN_L01', montage.labelnew)} = 'LFP_L01';
        montage.labelnew{strmatch('STN_L12', montage.labelnew)} = 'LFP_L12';
        montage.labelnew{strmatch('STN_L23', montage.labelnew)} = 'LFP_L23';
                
        
        
        ind   =  spm_match_str(montage.labelnew, {'EMG_R', 'EMG_L', 'Cz'});
        
        montage.labelnew(ind) = [];
        montage.tra(ind, :)  = [];
        
        
        montage.labelnew = [montage.labelnew(:); {'Fpz', 'Fz', 'Cz', 'Pz'}'];       
        montage.tra(strmatch('Fpz', montage.labelnew), strmatch('EEG009', montage.labelorg)) = 1;
        montage.tra(strmatch('Fz', montage.labelnew), strmatch('EEG010', montage.labelorg)) = 1;
        montage.tra(strmatch('Cz', montage.labelnew), strmatch('EEG011', montage.labelorg)) = 1;
        montage.tra(strmatch('Pz', montage.labelnew), strmatch('EEG012', montage.labelorg)) = 1;
        
        montage.labelnew = [montage.labelnew(:); {'Decs', 'Outc'}'];
        montage.labelorg = [montage.labelorg(:); {'UADC002', 'UADC003'}'];
        montage.tra((end+1):(end+2), (end+1):(end+2)) = eye(2);
        
        details.chanset = [details.chanset; {'UADC002', 'UADC003'}'];
end


for f=1:length(files)
    files{f} = fullfile(dbsroot, files{f});
end

root = fullfile(outroot, root);

if details.boston
    montage = load(fullfile(dbsroot, 'SPM','dbs_meg_boston_montage.mat'));
    name = fieldnames(montage);
    montage = getfield(montage, name{1});
end

if ~isempty(montage) && ~isempty(megbad)
    sel = spm_match_str(chan, megbad);
    chan(sel) = [];
    row = spm_match_str(montage.labelnew, megbad);
    col = spm_match_str(montage.labelorg, megbad);
    montage.tra(row, :) = [];
    montage.tra(:, col) = [];
    montage.labelorg(col) = [];
    montage.labelnew(row) = [];
end

if details.accelerometer
    montage.labelnew = [montage.labelnew(:); {'AccX', 'AccY', 'AccZ'}'];
    montage.labelorg = [montage.labelorg(:); {'AccX', 'AccY', 'AccZ'}'];
    montage.tra((end+1):(end+3), (end+1):(end+3)) = eye(3);
end

details.chan = chan;
details.montage = montage;

details.lfptocheck = chan;

